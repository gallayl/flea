var zt=Object.defineProperty;var At=(e,t,n)=>t in e?zt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var g=(e,t,n)=>At(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Ft={lifetime:"transient"},ue=Symbol("InjectableOptions"),bt=e=>typeof e[ue]=="object"&&typeof e[ue].lifetime=="string",ee=e=>{if(!bt(e))throw Error(`The class '${e.name}' is not an injectable`);return e[ue]},_=e=>t=>{Object.assign(t,{[ue]:{...Ft,...e}})},vt=(e,t=250)=>{let n;return(...i)=>{n&&clearTimeout(n),n=setTimeout(()=>{e(...i),n&&clearTimeout(n),n=void 0},t)}};class Re{constructor(){g(this,"listeners",new Map)}addListener(t,n){this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(n)}removeListener(t,n){this.listeners.has(t)&&this.listeners.get(t).delete(n)}subscribe(t,n){return this.addListener(t,n),{[Symbol.dispose]:()=>this.removeListener(t,n)}}emit(t,n){this.listeners.has(t)&&this.listeners.get(t).forEach(i=>i(n))}[Symbol.dispose](){this.listeners.clear()}}const pe=e=>(e==null?void 0:e[Symbol.asyncDispose])instanceof Function,me=e=>(e==null?void 0:e[Symbol.dispose])instanceof Function;class Bt{constructor(t,n,i){g(this,"observable");g(this,"callback");g(this,"options");this.observable=t,this.callback=n,this.options=i}[Symbol.dispose](){this.observable.unsubscribe(this)}}class le extends Error{constructor(){super("Observable already disposed")}}const Ht=(e,t)=>e!==t;class v{constructor(t,n){g(this,"_isDisposed",!1);g(this,"observers",new Set);g(this,"currentValue");g(this,"options");this.options={compare:Ht,...n},this.currentValue=t}get isDisposed(){return this._isDisposed}[Symbol.dispose](){this.observers.clear(),this._isDisposed=!0,this.currentValue=null}subscribe(t,n){if(this._isDisposed)throw new le;const i=new Bt(this,t,n);return this.observers.add(i),i}unsubscribe(t){return this.observers.delete(t)}getValue(){if(this._isDisposed)throw new le;return this.currentValue}setValue(t){if(this._isDisposed)throw new le;this.options.compare(this.currentValue,t)&&(this.currentValue=t,this.observers.forEach(n=>{var i,s;((s=(i=n.options)==null?void 0:i.filter)==null?void 0:s.call(i,this.currentValue,t))!==!1&&n.callback(t)}))}getObservers(){return[...this.observers]}}class qt{static trimSlashes(t){for(;t.endsWith("/");)t=t.substring(0,t.length-1);for(;t.startsWith("/");)t=t.substring(1,t.length);return t}static getSegments(t){return t.split("/").filter(n=>n&&n.length)}static joinPaths(...t){return t.map(n=>this.trimSlashes(n)).join("/")}static isAncestorOf(t,n){return n.indexOf(`${this.joinPaths(t)}/`)===0}static getParentPath(t){const n=this.getSegments(t);return n.length>1&&n.pop(),n.join("/")}static normalize(t){return this.getSegments(t).join("/")}}const Ut=(e=250)=>new Promise(t=>setTimeout(()=>{t()},e)),Gt=(e,t,n,i)=>{const s=i==="asc"?e:t,o=i==="asc"?t:e;return s[n]<o[n]?-1:s[n]>o[n]?1:0};Array.prototype.sortBy=function(e,t="asc"){return this.sort((n,i)=>Gt(n,i,e,t))};var Wt=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},Oe;const Jt=e=>typeof e.init=="function";class W extends Error{constructor(){super("Injector already disposed")}}const qe=["singleton","scoped","explicit"];class Qt extends Error{constructor(t){super(`Cannot instantiate an instance of '${t.name}' as it's lifetime is set to 'explicit'. Ensure to initialize it properly`)}}let H=Oe=class{constructor(){g(this,"isDisposed",!1);g(this,"options",{});g(this,"cachedSingletons",new Map);g(this,"remove",t=>{if(this.isDisposed)throw new W;this.cachedSingletons.delete(t)})}async[Symbol.asyncDispose](){if(this.isDisposed)throw new W;this.isDisposed=!0;const n=Array.from(this.cachedSingletons.entries()).map(o=>o[1]).filter(o=>o!==this).map(async o=>{me(o)&&o[Symbol.dispose](),pe(o)&&await o[Symbol.asyncDispose]()}),s=(await Promise.allSettled(n)).filter(o=>o.status==="rejected");if(s&&s.length)throw new Error(`There was an error during disposing '${s.length}' global disposable objects: ${s.map(o=>o.reason).join(", ")}`);this.cachedSingletons.clear()}getInstance(t){return Ue(this.getInstanceInternal(t),this)}getInstanceInternal(t){if(this.isDisposed)throw new W;if(t===this.constructor)return this;const n=this.cachedSingletons.get(t);if(n)return n;const i=ee(t),{lifetime:s}=i,o=(s==="singleton"||s==="explicit")&&this.options.parent&&this.options.parent.getInstanceInternal(t);if(o)return o;if(s==="explicit")throw new Qt(t);const r=[...xt(t)];if(r.includes(t))throw Error("Circular dependencies found.");if(s==="singleton"){const d=r.map(l=>({meta:ee(l),dep:l})).filter(l=>l.meta&&(l.meta.lifetime==="scoped"||l.meta.lifetime==="transient")).map(l=>l.meta&&`${l.dep.name}:${l.meta.lifetime}`);if(d.length)throw Error(`Injector error: Singleton type '${t.name}' depends on non-singleton injectables: ${d.join(",")}`)}else if(s==="scoped"){const d=r.map(l=>({meta:ee(l),dep:l})).filter(l=>l.meta&&l.meta.lifetime==="transient").map(l=>l.meta&&`${l.dep.name}:${l.meta.lifetime}`);if(d.length)throw Error(`Injector error: Scoped type '${t.name}' depends on transient injectables: ${d.join(",")}`)}const a=new t;return qe.includes(s)&&this.setExplicitInstance(a),Jt(a)&&Ue(a,this).init(this),a}setExplicitInstance(t,n){if(this.isDisposed)throw new W;const i=n||t.constructor,{lifetime:s}=ee(i);if(t.constructor===this.constructor)throw Error("Cannot set an injector instance as injectable");if(!qe.includes(s))throw new Error(`Cannot set an instance of '${i.name}' as it's lifetime is set to '${s}'`);this.cachedSingletons.set(i,t)}createChild(t){if(this.isDisposed)throw new W;const n=new Oe;return n.options=n.options||t,n.options.parent=this,n}};H=Oe=Wt([_({lifetime:"system"})],H);const wt=e=>e&&typeof e=="object"&&"injector"in e&&e.injector instanceof H,Ue=(e,t)=>(Object.assign(e,{injector:t}),e),Ge=e=>{if(!wt(e))throw new Error("The instance does not have an injector reference");return e.injector},We=Symbol("InjectableDependencyList"),xt=e=>{const t=e[We];if(t&&t instanceof Set)return t;const n=new Set;return Object.assign(e,{[We]:n}),n},Yt=(e,t)=>{xt(e).add(t)},X=e=>(t,n)=>{bt(e)?(Yt(t.constructor,e),Object.defineProperty(t.constructor.prototype,n,{set(){throw new Error(`Injected property '${t.constructor.name}.${n.toString()}' is read-only`)},get(){return Ge(this).getInstance(e)}})):Object.defineProperty(t.constructor.prototype,n,{set(){throw new Error(`Injected property '${t.constructor.name}.${n.toString()}' is read-only`)},get(){return e.call(this,Ge(this))}})},Je="@furystack/core/AbstractLogger";class Pe{constructor(){g(this,"withScope",t=>({addEntry:n=>this.addEntry({scope:t,...n}),verbose:n=>this.verbose({scope:t,...n}),debug:n=>this.debug({scope:t,...n}),information:n=>this.information({scope:t,...n}),warning:n=>this.warning({scope:t,...n}),error:n=>this.error({scope:t,...n}),fatal:n=>this.fatal({scope:t,...n})}))}async addEntryInternal(t){try{await this.addEntry(t)}catch(n){await this.error({scope:Je,message:"There was an error adding entry to the log",data:{entry:t,error:n}})}}async verbose(t){await this.addEntryInternal({...t,level:"verbose"})}async debug(t){await this.addEntryInternal({...t,level:"debug"})}async information(t){await this.addEntryInternal({...t,level:"information"})}async warning(t){await this.addEntryInternal({...t,level:"warning"})}async error(t){try{await this.addEntry({...t,level:"error"})}catch(n){await this.fatal({scope:Je,message:"There was an error persisting an Error event in the log and therefore the event was elevated to Fatal level.",data:{originalEntry:t,error:n}})}}async fatal(t){await this.addEntry({...t,level:"fatal"})}}var St=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};const Ce="\x1B[0m",Qe="\x1B[31m",Xt="\x1B[32m",Kt="\x1B[33m",Zt="\x1B[34m",en="\x1B[36m",Ot=e=>{switch(e){case"verbose":return en;case"debug":return Zt;case"information":return Xt;case"warning":return Kt;case"error":return Qe;default:return Qe}},tn=e=>[`${Ot(e.level)}%s${Ce}`,e.scope,e.message],nn=e=>{const t=Ot(e.level);return e.data?[`${t}%s${Ce}`,e.scope,e.message,e.data]:[`${t}%s${Ce}`,e.scope,e.message]};let Ye=class extends Pe{async addEntry(t){const n=tn(t);console.log(...n)}};Ye=St([_({lifetime:"scoped"})],Ye);let Ie=class extends Pe{async addEntry(t){const n=nn(t);console.log(...n)}};Ie=St([_({lifetime:"scoped"})],Ie);var sn=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};let Q=class extends Pe{constructor(){super(...arguments);g(this,"loggers",[])}async addEntry(n){const i=this.loggers.map(s=>s!==this?s.addEntry(n):Promise.resolve());await Promise.all(i)}attachLogger(...n){this.loggers.push(...n)}detach(n){this.loggers=this.loggers.filter(i=>i!==n)}};Q=sn([_({lifetime:"singleton"})],Q);const on=(e,...t)=>{const n=t.map(s=>e.getInstance(s)),i=e.getInstance(Q);i.attachLogger(...n),e.setExplicitInstance(i,Q)},Ct=e=>e.getInstance(Q);var F=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},M={};Object.defineProperty(M,"__esModule",{value:!0});M.TokenData=void 0;M.parse=$e;var rn=M.compile=un,It=M.match=hn;M.pathToRegexp=Dt;M.stringify=mn;const Te="/",je=e=>e,Et=/^[$_\p{ID_Start}]$/u,Ve=/^[$\u200c\u200d\p{ID_Continue}]$/u,fe="https://git.new/pathToRegexpError",an={"{":"{","}":"}","(":"(",")":")","[":"[","]":"]","+":"+","?":"?","!":"!"};function ln(e){return e.replace(/[{}()\[\]+?!:*]/g,"\\$&")}function N(e){return e.replace(/[.+*?^${}()[\]|/\\]/g,"\\$&")}function*cn(e){const t=[...e];let n=0;function i(){let s="";if(Et.test(t[++n]))for(s+=t[n];Ve.test(t[++n]);)s+=t[n];else if(t[n]==='"'){let o=n;for(;n<t.length;){if(t[++n]==='"'){n++,o=0;break}t[n]==="\\"?s+=t[++n]:s+=t[n]}if(o)throw new TypeError(`Unterminated quote at ${o}: ${fe}`)}if(!s)throw new TypeError(`Missing parameter name at ${n}: ${fe}`);return s}for(;n<t.length;){const s=t[n],o=an[s];if(o)yield{type:o,index:n++,value:s};else if(s==="\\")yield{type:"ESCAPED",index:n++,value:t[n++]};else if(s===":"){const r=i();yield{type:"PARAM",index:n,value:r}}else if(s==="*"){const r=i();yield{type:"WILDCARD",index:n,value:r}}else yield{type:"CHAR",index:n,value:t[n++]}}return{type:"END",index:n,value:""}}class dn{constructor(t){this.tokens=t}peek(){if(!this._peek){const t=this.tokens.next();this._peek=t.value}return this._peek}tryConsume(t){const n=this.peek();if(n.type===t)return this._peek=void 0,n.value}consume(t){const n=this.tryConsume(t);if(n!==void 0)return n;const{type:i,index:s}=this.peek();throw new TypeError(`Unexpected ${i} at ${s}, expected ${t}: ${fe}`)}text(){let t="",n;for(;n=this.tryConsume("CHAR")||this.tryConsume("ESCAPED");)t+=n;return t}}class ye{constructor(t){this.tokens=t}}M.TokenData=ye;function $e(e,t={}){const{encodePath:n=je}=t,i=new dn(cn(e));function s(r){const a=[];for(;;){const d=i.text();d&&a.push({type:"text",value:n(d)});const l=i.tryConsume("PARAM");if(l){a.push({type:"param",name:l});continue}const h=i.tryConsume("WILDCARD");if(h){a.push({type:"wildcard",name:h});continue}if(i.tryConsume("{")){a.push({type:"group",tokens:s("}")});continue}return i.consume(r),a}}const o=s("END");return new ye(o)}function un(e,t={}){const{encode:n=encodeURIComponent,delimiter:i=Te}=t,s=e instanceof ye?e:$e(e,t),o=_t(s.tokens,i,n);return function(a={}){const[d,...l]=o(a);if(l.length)throw new TypeError(`Missing parameters: ${l.join(", ")}`);return d}}function _t(e,t,n){const i=e.map(s=>fn(s,t,n));return s=>{const o=[""];for(const r of i){const[a,...d]=r(s);o[0]+=a,o.push(...d)}return o}}function fn(e,t,n){if(e.type==="text")return()=>[e.value];if(e.type==="group"){const s=_t(e.tokens,t,n);return o=>{const[r,...a]=s(o);return a.length?[""]:[r]}}const i=n||je;return e.type==="wildcard"&&n!==!1?s=>{const o=s[e.name];if(o==null)return["",e.name];if(!Array.isArray(o)||o.length===0)throw new TypeError(`Expected "${e.name}" to be a non-empty array`);return[o.map((r,a)=>{if(typeof r!="string")throw new TypeError(`Expected "${e.name}/${a}" to be a string`);return i(r)}).join(t)]}:s=>{const o=s[e.name];if(o==null)return["",e.name];if(typeof o!="string")throw new TypeError(`Expected "${e.name}" to be a string`);return[i(o)]}}function hn(e,t={}){const{decode:n=decodeURIComponent,delimiter:i=Te}=t,{regexp:s,keys:o}=Dt(e,t),r=o.map(a=>n===!1?je:a.type==="param"?n:d=>d.split(i).map(n));return function(d){const l=s.exec(d);if(!l)return!1;const h=l[0],u=Object.create(null);for(let f=1;f<l.length;f++){if(l[f]===void 0)continue;const p=o[f-1],m=r[f-1];u[p.name]=m(l[f])}return{path:h,params:u}}}function Dt(e,t={}){const{delimiter:n=Te,end:i=!0,sensitive:s=!1,trailing:o=!0}=t,r=[],a=[],d=s?"":"i",h=(Array.isArray(e)?e:[e]).map(p=>p instanceof ye?p:$e(p,t));for(const{tokens:p}of h)for(const m of ce(p,0,[])){const S=gn(m,n,r);a.push(S)}let u=`^(?:${a.join("|")})`;return o&&(u+=`(?:${N(n)}$)?`),u+=i?"$":`(?=${N(n)}|$)`,{regexp:new RegExp(u,d),keys:r}}function*ce(e,t,n){if(t===e.length)return yield n;const i=e[t];if(i.type==="group"){const s=n.slice();for(const o of ce(i.tokens,0,s))yield*ce(e,t+1,o)}else n.push(i);yield*ce(e,t+1,n)}function gn(e,t,n){let i="",s="",o=!0;for(let r=0;r<e.length;r++){const a=e[r];if(a.type==="text"){i+=N(a.value),s+=a.value,o||(o=a.value.includes(t));continue}if(a.type==="param"||a.type==="wildcard"){if(!o&&!s)throw new TypeError(`Missing text after "${a.name}": ${fe}`);a.type==="param"?i+=`(${pn(t,o?"":s)}+)`:i+="([\\s\\S]+)",n.push(a),s="",o=!1;continue}}return i}function pn(e,t){return t.length<2?e.length<2?`[^${N(e+t)}]`:`(?:(?!${N(e)})[^${N(t)}])`:e.length<2?`(?:(?!${N(t)})[^${N(e)}])`:`(?:(?!${N(t)}|${N(e)})[\\s\\S])`}function mn(e){return e.tokens.map(function t(n,i,s){if(n.type==="text")return ln(n.value);if(n.type==="group")return`{${n.tokens.map(t).join("")}}`;const r=yn(n.name)&&bn(s[i+1])?n.name:JSON.stringify(n.name);if(n.type==="param")return`:${r}`;if(n.type==="wildcard")return`*${r}`;throw new TypeError(`Unexpected token: ${n}`)}).join("")}function yn(e){const[t,...n]=e;return Et.test(t)?n.every(i=>Ve.test(i)):!1}function bn(e){return(e==null?void 0:e.type)!=="text"?!0:!Ve.test(e.value[0])}const vn=e=>Object.fromEntries(Object.entries(e).map(([t,n])=>[t,n==null?void 0:n.toString()])),wn=(e,t)=>rn(e)(vn(t)),xn=e=>JSON.parse(decodeURIComponent(escape(atob(decodeURIComponent(e))))),Sn=e=>{const t=[...new URLSearchParams(e).entries()].filter(([n,i])=>n&&i).map(([n,i])=>[n,xn(i)]);return Object.fromEntries(t)},On=e=>encodeURIComponent(btoa(unescape(encodeURIComponent(JSON.stringify(e))))),Cn=e=>new URLSearchParams(Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0).map(([t,n])=>[t,On(n)]))).toString();var In=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},En=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)};let $=class{constructor(t=Cn,n=Sn){g(this,"serializeToQueryString");g(this,"deserializeQueryString");g(this,"originalPushState");g(this,"originalReplaceState");g(this,"onLocationPathChanged",new v(new URL(location.href).pathname));g(this,"onLocationHashChanged",new v(location.hash.replace("#","")));g(this,"onLocationSearchChanged",new v(location.search));g(this,"onDeserializedLocationSearchChanged");g(this,"locationDeserializerObserver",this.onLocationSearchChanged.subscribe(t=>{this.onDeserializedLocationSearchChanged.setValue(this.deserializeQueryString(t))}));g(this,"updateState",(()=>{this.onLocationPathChanged.setValue(location.pathname),this.onLocationHashChanged.setValue(location.hash.replace("#","")),this.onLocationSearchChanged.setValue(location.search)}).bind(this));g(this,"searchParamObservables",new Map);g(this,"popStateListener",t=>{this.updateState()});g(this,"hashChangeListener",(t=>{this.updateState()}).bind(this));this.serializeToQueryString=t,this.deserializeQueryString=n,window.addEventListener("popstate",this.popStateListener),window.addEventListener("hashchange",this.hashChangeListener),this.onDeserializedLocationSearchChanged=new v(this.deserializeQueryString(location.search)),this.originalPushState=window.history.pushState.bind(window.history),window.history.pushState=((...i)=>{this.originalPushState(...i),this.updateState()}).bind(this),this.originalReplaceState=window.history.replaceState.bind(window.history),window.history.replaceState=((...i)=>{this.originalReplaceState(...i),this.updateState()}).bind(this)}[Symbol.dispose](){window.removeEventListener("popstate",this.popStateListener),window.removeEventListener("hashchange",this.hashChangeListener),this.onLocationPathChanged[Symbol.dispose](),this.onLocationSearchChanged[Symbol.dispose](),this.onDeserializedLocationSearchChanged[Symbol.dispose](),this.locationDeserializerObserver[Symbol.dispose](),window.history.pushState=this.originalPushState,window.history.replaceState=this.originalReplaceState}useSearchParam(t,n){const i=this.searchParamObservables.get(t);if(!i){const s=this.onDeserializedLocationSearchChanged.getValue(),o=Object.prototype.hasOwnProperty.call(s,t)?s[t]:n,r=new v(o);return this.searchParamObservables.set(t,r),r.subscribe(a=>{const d=this.onDeserializedLocationSearchChanged.getValue();if(d[t]!==a){const l=this.serializeToQueryString({...d,[t]:a}),h=`${location.pathname}?${l}`;history.pushState({},"",h)}}),this.onDeserializedLocationSearchChanged.subscribe(a=>{var l;const d=a[t]??n;(l=this.searchParamObservables.get(t))==null||l.setValue(d)}),r}return i}};$=In([_({lifetime:"singleton"}),En("design:paramtypes",[Object,Object])],$);class kt extends Error{constructor(n,i){super(n);g(this,"rejections");this.rejections=i}}var _n=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};let Xe=class{constructor(){g(this,"stores",new Map)}async[Symbol.asyncDispose](){const n=(await Promise.allSettled([...this.stores.entries()].map(async([i,s])=>{me(s)&&s[Symbol.dispose](),pe(s)&&await s[Symbol.asyncDispose]()}))).filter(i=>i.status==="rejected");if(n&&n.length)throw new kt(`There was an error during disposing ${n.length} stores: ${n.map(s=>s.reason).join(", ")}`,n)}getStoreFor(t,n){const i=this.stores.get(t);if(!i)throw Error(`Store not found for '${t.name}'`);if(n!==i.primaryKey)throw Error("Primary keys not match");return i}addStore(t){return this.stores.set(t.model,t),this}};Xe=_n([_({lifetime:"singleton"})],Xe);const Dn=new Set,A=(()=>Promise.allSettled([...Dn].map(async e=>{pe(e)&&await e[Symbol.asyncDispose](),me(e)&&e[Symbol.dispose]()})).then(e=>{const t=e.filter(n=>n.status==="rejected");t&&t.length&&console.warn(`There was an error during disposing '${t.length}' global disposable objects`,t)}).catch(e=>{console.error("Error during disposing global disposables",e)})).bind(null);var ne,ut;(ut=(ne=globalThis.process)==null?void 0:ne.on)==null||ut.call(ne,"exit",A);var ie,ft;(ft=(ie=globalThis.process)==null?void 0:ie.on)==null||ft.call(ie,"SIGINT",A);var se,ht;(ht=(se=globalThis.process)==null?void 0:se.on)==null||ht.call(se,"SIGTERM",A);var oe,gt;(gt=(oe=globalThis.process)==null?void 0:oe.on)==null||gt.call(oe,"SIGUSR1",A);var re,pt;(pt=(re=globalThis.process)==null?void 0:re.on)==null||pt.call(re,"SIGUSR2",A);var ae,mt;(mt=(ae=globalThis.process)==null?void 0:ae.on)==null||mt.call(ae,"uncaughtException",A);var yt;(yt=globalThis.window)==null||yt.addEventListener("beforeunload",A);var kn=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};let Ke=class{isAuthenticated(){return Promise.resolve(!1)}isAuthorized(...t){return Promise.resolve(!1)}getCurrentUser(){throw new Error("No IdentityContext")}};Ke=kn([_({lifetime:"scoped"})],Ke);class Ln{constructor(){g(this,"disposables",new Map);g(this,"observers",new Map);g(this,"useObservable",(t,n,i,s)=>{const o=this.observers.get(t);if(o)return[o.observable.getValue(),o.observable.setValue.bind(o.observable)];const r=n.subscribe(i,s);return this.observers.set(t,r),[n.getValue(),n.setValue.bind(n)]});g(this,"stateObservers",new Map);g(this,"useState",(t,n,i)=>{if(!this.stateObservers.has(t)){const o=new v(n);this.stateObservers.set(t,o),o.subscribe(i)}const s=this.stateObservers.get(t);return[s.getValue(),s.setValue.bind(s)]})}useDisposable(t,n){const i=this.disposables.get(t);if(!i){const s=n();return this.disposables.set(t,s),s}return i}async[Symbol.asyncDispose](){const n=(await Promise.allSettled([...this.disposables].map(async([i,s])=>{me(s)&&s[Symbol.dispose](),pe(s)&&await s[Symbol.asyncDispose]()}))).filter(i=>i.status==="rejected");if(n&&n.length)throw new kt(`There was an error during disposing ${n.length} stores: ${n.map(s=>s.reason).join(", ")}`,n);this.disposables.clear(),this.observers.forEach(i=>i[Symbol.dispose]()),this.observers.clear(),this.stateObservers.forEach(i=>i[Symbol.dispose]()),this.stateObservers.clear()}}const Nn=e=>typeof e=="function",Me=(e,t)=>{for(const n of t)typeof n=="string"||typeof n=="number"?e.appendChild(document.createTextNode(n)):n instanceof HTMLElement||n instanceof DocumentFragment?e.appendChild(n):n instanceof Array&&Me(e,n)},Lt=e=>!!e&&typeof e=="object"&&typeof e.style=="object",P=(e,t)=>{if(Lt(t))for(const n in t.style)Object.prototype.hasOwnProperty.call(t.style,n)&&(e.style[n]=t.style[n])},Rn=(e,t)=>{t&&Object.entries(t).filter(([n])=>n.startsWith("data-")).forEach(([n,i])=>e.setAttribute(n,i||""))},R=(e,t)=>{if(t){if(P(e,t),Lt(t)){const{style:n,...i}=t;Object.assign(e,i)}else Object.assign(e,t);Rn(e,t)}},Pn=(...[e,t,...n])=>{if(typeof e=="string"){const i=document.createElement(e);return R(i,t),n&&Me(i,n),i}else if(Nn(e)){const i=e(t,n);return P(i,t),i}},Tn=(...[e,...t])=>{const n=document.createDocumentFragment();return Me(n,t),n},c=(...e)=>e[0]===null?Tn(...e):Pn(...e),y=e=>{const t=e.shadowDomName;if(customElements.get(t))throw Error(`A custom shade with shadow DOM name '${e.shadowDomName}' has already been registered!`);{const i=e.elementBase||HTMLElement;customElements.define(t,class extends i{constructor(){super(...arguments);g(this,"_renderCount",0);g(this,"resourceManager",new Ln);g(this,"props");g(this,"shadeChildren");g(this,"render",o=>(this._renderCount++,e.render(o)));g(this,"getRenderOptions",()=>({props:this.props,injector:this.injector,children:this.shadeChildren,element:this,renderCount:this._renderCount,useObservable:(r,a,d)=>{const l=(d==null?void 0:d.onChange)||(()=>this.updateComponent());return this.resourceManager.useObservable(r,a,l,d)},useState:(r,a)=>this.resourceManager.useState(r,a,this.updateComponent.bind(this)),useSearchState:(r,a)=>this.resourceManager.useObservable(`useSearchState-${r}`,this.injector.getInstance($).useSearchParam(r,a),()=>this.updateComponent()),useStoredState:(r,a,d=localStorage)=>{const l=()=>{const p=d==null?void 0:d.getItem(r);return p?JSON.parse(p):a},h=p=>{if(JSON.stringify(p)!==(d==null?void 0:d.getItem(r))){const m=JSON.stringify(p);d==null||d.setItem(r,m)}JSON.stringify(u.getValue())!==JSON.stringify(p)&&u.setValue(p)},u=this.resourceManager.useDisposable(`useStoredState-${r}`,()=>new v(l())),f=p=>{p.key===r&&p.storageArea===d&&h(p.newValue&&JSON.parse(p.newValue)||a)};return this.resourceManager.useDisposable(`useStoredState-${r}-storage-event`,()=>{window.addEventListener("storage",f);const p="useStoredState-broadcast-channel",m=new BroadcastChannel(p);m.onmessage=w=>{w.data.key===r&&h(w.data.value)};const S=u.subscribe(w=>{m.postMessage({key:r,value:w})});return{[Symbol.dispose]:()=>{window.removeEventListener("storage",f),S[Symbol.dispose](),m.close()}}}),u.subscribe(h),this.resourceManager.useObservable(`useStoredState-${r}`,u,()=>this.updateComponent())},useDisposable:this.resourceManager.useDisposable.bind(this.resourceManager)}));g(this,"cleanup");g(this,"_injector")}getRenderCount(){return this._renderCount}connectedCallback(){var o;(o=e.onAttach)==null||o.call(e,this.getRenderOptions()),this.callConstructed()}async disconnectedCallback(){var o,r;(o=e.onDetach)==null||o.call(e,this.getRenderOptions()),await this.resourceManager[Symbol.asyncDispose](),(r=this.cleanup)==null||r.call(this)}updateComponent(){const o=this.render(this.getRenderOptions());o==null&&(this.innerHTML=""),(typeof o=="string"||typeof o=="number")&&(this.innerHTML=o),o instanceof HTMLElement&&this.replaceChildren(o),o instanceof DocumentFragment&&this.replaceChildren(o)}callConstructed(){this.updateComponent();const o=e.constructed&&e.constructed(this.getRenderOptions());o instanceof Promise?o.then(r=>this.cleanup=r).catch(()=>{}):this.cleanup=o}getInjectorFromParent(){let o=this.parentElement;for(;o;){if(o.injector)return o.injector;o=o.parentElement}}get injector(){if(this._injector)return this._injector;const o=wt(this.props)&&this.props.injector;if(o&&o instanceof H)return o;const r=this.getInjectorFromParent();return r?(this._injector=r,r):new H}set injector(o){this._injector=o}},e.elementBaseName?{extends:e.elementBaseName}:void 0)}return(i,s)=>{const o=customElements.get(t),r=new o({...i});return r.props=i||{},r.shadeChildren=s,P(r,{style:e.style}),R(r,i),r}};y({shadowDomName:"lazy-load",constructed:async({props:e,useState:t,element:n})=>{const[i,s]=t("component",void 0),[o,r]=t("error",void 0);try{const a=await e.component();n.isConnected&&s(a)}catch(a){if(e.error)n.isConnected&&r(a);else throw a}},render:({props:e,useState:t})=>{const[n,i]=t("error",void 0),[s,o]=t("component",void 0);return n&&e.error?e.error(n,async()=>{try{i(void 0),o(void 0);const r=await e.component();o(r)}catch(r){i(r)}}):s||e.loader}});y({shadowDomName:"link-to-route",elementBase:HTMLAnchorElement,elementBaseName:"a",render:({props:e,element:t,children:n})=>{const{route:i,params:s}=e,o=wn(i.url,s);return t.setAttribute("href",o),c(c,null,n)}});var Nt={},ze={};(function(e){var t=F&&F.__awaiter||function(s,o,r,a){return new(r||(r=Promise))(function(d,l){function h(p){try{f(a.next(p))}catch(m){l(m)}}function u(p){try{f(a.throw(p))}catch(m){l(m)}}function f(p){p.done?d(p.value):new r(function(m){m(p.value)}).then(h,u)}f((a=a.apply(s,o||[])).next())})},n=F&&F.__generator||function(s,o){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,d,l;return{next:h(0),throw:h(1),return:h(2)};function h(f){return function(p){return u([f,p])}}function u(f){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,d&&(l=d[f[0]&2?"return":f[0]?"throw":"next"])&&!(l=l.call(d,f[1])).done)return l;switch(d=0,l&&(f=[0,l.value]),f[0]){case 0:case 1:l=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,d=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!l||f[1]>l[0]&&f[1]<l[3])){r.label=f[1];break}if(f[0]===6&&r.label<l[1]){r.label=l[1],l=f;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(f);break}l[2]&&r.ops.pop(),r.trys.pop();continue}f=o.call(s,r)}catch(p){f=[6,p],d=0}finally{a=l=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};e.__esModule=!0;var i=function(){function s(o){this.promiseResolverQueue=[],this.permits=o}return s.prototype.getPermits=function(){return this.permits},s.prototype.wait=function(){return t(this,void 0,void 0,function(){var o=this;return n(this,function(r){return this.permits>0?(this.permits-=1,[2,Promise.resolve(!0)]):[2,new Promise(function(a){return o.promiseResolverQueue.push(a)})]})})},s.prototype.acquire=function(){return t(this,void 0,void 0,function(){return n(this,function(o){return[2,this.wait()]})})},s.prototype.waitFor=function(o){return t(this,void 0,void 0,function(){var r=this,a,d;return n(this,function(l){return this.permits>0?(this.permits-=1,[2,Promise.resolve(!0)]):(a=function(h){},d=new Promise(function(h){a=h}),this.promiseResolverQueue.push(a),setTimeout(function(){var h=r.promiseResolverQueue.indexOf(a);h!==-1&&r.promiseResolverQueue.splice(h,1),a(!1)},o),[2,d])})})},s.prototype.tryAcquire=function(){return this.permits>0?(this.permits-=1,!0):!1},s.prototype.drainPermits=function(){if(this.permits>0){var o=this.permits;return this.permits=0,o}return 0},s.prototype.signal=function(){if(this.permits+=1,this.permits>1&&this.promiseResolverQueue.length>0)throw new Error("this.permits should never be > 0 when there is someone waiting.");if(this.permits===1&&this.promiseResolverQueue.length>0){this.permits-=1;var o=this.promiseResolverQueue.shift();o&&o(!0)}},s.prototype.release=function(){this.signal()},s.prototype.execute=function(o){return t(this,void 0,void 0,function(){return n(this,function(r){switch(r.label){case 0:return[4,this.wait()];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,o()];case 3:return[2,r.sent()];case 4:return this.signal(),[7];case 5:return[2]}})})},s}();e.default=i})(ze);var Ae={},jn=F&&F.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Ae.__esModule=!0;var Vn=ze,$n=function(e){jn(t,e);function t(){return e.call(this,1)||this}return t}(Vn.default);Ae.Lock=$n;(function(e){function t(i){for(var s in i)e.hasOwnProperty(s)||(e[s]=i[s])}e.__esModule=!0;var n=ze;e.default=n.default,t(Ae)})(Nt);const Mn=y({shadowDomName:"shade-router",render:e=>{const{useState:t,useObservable:n,injector:i}=e,[s]=t("lock",new Nt.Lock),[o,r]=t("routerState",{jsx:c("div",null)}),a=async l=>{var m,S,w;const[h]=t("routerState",o),{activeRoute:u,activeRouteParams:f,jsx:p}=h;try{await s.acquire();for(const x of e.props.routes){const k=It(x.url,x.routingOptions)(l);if(k){if(x!==u||JSON.stringify(f)!==JSON.stringify(k.params)){await((m=u==null?void 0:u.onLeave)==null?void 0:m.call(u,{...e,element:h.jsx}));const L=x.component({currentUrl:l,match:k});r({jsx:L,activeRoute:x,activeRouteParams:k.params}),await((S=x.onVisit)==null?void 0:S.call(x,{...e,element:L}))}return}}u!==null&&(await((w=u==null?void 0:u.onLeave)==null?void 0:w.call(u,{...e,element:p})),r({jsx:e.props.notFound||c("div",null),activeRoute:null,activeRouteParams:null}))}catch(x){if(!(x instanceof le))throw x}finally{s==null||s.release()}},[d]=n("locationPathChanged",i.getInstance($).onLocationPathChanged,{onChange:l=>{a(l)}});return a(d),o.jsx}}),zn=y({shadowDomName:"route-link",elementBase:HTMLAnchorElement,elementBaseName:"a",render:({children:e,props:t,injector:n,element:i})=>(R(i,{...t,style:{color:"inherit",textDecoration:"inherit",...t.style},onclick:s=>{s.preventDefault(),history.pushState("",t.title||"",t.href),n.getInstance($).updateState()}}),c(c,null,e))}),An=e=>{e.jsxElement.injector=e.injector,e.rootElement.appendChild(e.jsxElement)};var Fn=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},Bn=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)};const Hn=["xs","sm","md","lg","xl"];let Ze=class{constructor(){g(this,"getOrientation",()=>{var t;return(t=window.matchMedia)!=null&&t.call(window,"(orientation:landscape").matches?"landscape":"portrait"});g(this,"breakpoints",{xl:{minSize:1920},lg:{minSize:1280},md:{minSize:960},sm:{minSize:600},xs:{minSize:0}});g(this,"screenSize",{atLeast:{xs:new v(this.screenSizeAtLeast("xs")),sm:new v(this.screenSizeAtLeast("sm")),md:new v(this.screenSizeAtLeast("md")),lg:new v(this.screenSizeAtLeast("lg")),xl:new v(this.screenSizeAtLeast("xl"))}});g(this,"orientation",new v(this.getOrientation()));g(this,"onResizeListener",()=>{this.refreshValues()});window.addEventListener("resize",this.onResizeListener),this.refreshValues()}[Symbol.dispose](){window.removeEventListener("resize",this.onResizeListener)}screenSizeAtLeast(t){return window.innerWidth>=this.breakpoints[t].minSize}refreshValues(){this.orientation.setValue(this.getOrientation()),Hn.forEach(t=>{this.screenSize.atLeast[t].setValue(this.screenSizeAtLeast(t))})}};Ze=Fn([_({lifetime:"singleton"}),Bn("design:paramtypes",[])],Ze);var qn=Object.defineProperty,Un=Object.getOwnPropertyDescriptor,Gn=(e,t,n,i)=>{for(var s=i>1?void 0:i?Un(t,n):t,o=e.length-1,r;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&qn(t,n,s),s};let V=class{};V=Gn([_({lifetime:"singleton"})],V);const b=async(e,t,n)=>new Promise((i,s)=>{if(!e)return s(new Error("No element provided"));const o=e.animate(t,n);o.onfinish=i,o.oncancel=s}),et=(e,t)=>b(e,[{height:`${e==null?void 0:e.scrollHeight}px`,opacity:1},{height:"0px",opacity:0}],{duration:500,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",fill:"forwards",...t}),tt=(e,t)=>b(e,[{height:"0px",opacity:0},{height:`${e==null?void 0:e.scrollHeight}px`,opacity:1}],{duration:500,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",fill:"forwards",...t}),Ee={name:"css-variable-theme",text:{primary:"var(--shades-theme-text-primary)",secondary:"var(--shades-theme-text-secondary)",disabled:"var(--shades-theme-text-disabled)"},button:{active:"var(--shades-theme-button-active)",hover:"var(--shades-theme-button-hover)",selected:"var(--shades-theme-button-selected)",disabled:"var(--shades-theme-button-disabled)",disabledBackground:"var(--shades-theme-button-disabled-background)"},background:{default:"var(--shades-theme-background-default)",paper:"var(--shades-theme-background-paper)"},palette:{primary:{light:"var(--shades-theme-palette-primary-light)",main:"var(--shades-theme-palette-primary-main)",dark:"var(--shades-theme-palette-primary-dark)"},secondary:{light:"var(--shades-theme-palette-secondary-light)",main:"var(--shades-theme-palette-secondary-main)",dark:"var(--shades-theme-palette-secondary-dark)"},error:{light:"var(--shades-theme-palette-error-light)",main:"var(--shades-theme-palette-error-main)",dark:"var(--shades-theme-palette-error-dark)"},warning:{light:"var(--shades-theme-palette-warning-light)",main:"var(--shades-theme-palette-warning-main)",dark:"var(--shades-theme-palette-warning-dark)"},info:{light:"var(--shades-theme-palette-info-light)",main:"var(--shades-theme-palette-info-main)",dark:"var(--shades-theme-palette-info-dark)"},success:{light:"var(--shades-theme-palette-success-light)",main:"var(--shades-theme-palette-success-main)",dark:"var(--shades-theme-palette-success-dark)"}},divider:"var(--shades-theme-divider)"},Wn=(e,t,n)=>{n.style.setProperty(e.replace("var(","").replace(")",""),t)},Jn=(e,t=document.querySelector(":root"))=>getComputedStyle(t).getPropertyValue(e.replace("var(","").replace(")","")),Rt=(e,t,n,i=Wn)=>{Object.keys(e).forEach(o=>{if(typeof t[o]=="object"&&typeof e[o]=="object"){Rt(e[o],t[o],n);return}else i(e[o],t[o],n)})},Pt=e=>{const t=document.querySelector(":root");Rt(Ee,e,t)};var Qn=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};class we{constructor(t,n,i,s=1){g(this,"r");g(this,"g");g(this,"b");g(this,"a");this.r=t,this.g=n,this.b=i,this.a=s}update(t,n){return this[t]=n,this}toString(){return`rgba(${this.r},${this.g},${this.b},${this.a})`}}let O=class extends Re{constructor(){super(...arguments);g(this,"theme",Ee);g(this,"_assignedTheme",Ee)}getTextColor(n,i="#000000",s="#FFFFFF"){const{r:o,g:r,b:a}=this.getRgbFromColorString(n);return(o*299+r*587+a*114)/1e3>=128?i:s}getRgbFromColorString(n){if(n.startsWith("var(--"))return this.getRgbFromColorString(Jn(n));if(n.startsWith("#")){if(n.length===7){const i=parseInt(n.substr(1,2),16),s=parseInt(n.substr(3,2),16),o=parseInt(n.substr(5,2),16);return new we(i,s,o)}if(n.length===4){const i=parseInt(n.substr(1,1)+n.substr(1,1),16),s=parseInt(n.substr(2,1)+n.substr(2,1),16),o=parseInt(n.substr(3,1)+n.substr(3,1),16);return new we(i,s,o)}}if(n.startsWith("rgba(")){const i=new RegExp(/^rgba[(](?<red>[\d]+)[,][\s]?(?<green>[\d]+)[,][\s]?(?<blue>[\d]+)[,][\s]?(?<alpha>[\d|.]+)[)]/gm).exec(n);if(i&&i.groups)return new we(parseInt(i.groups.red,10),parseInt(i.groups.green,10),parseInt(i.groups.blue,10),parseInt(i.groups.alpha,10))}throw Error(`Color format '${n}' is not supported.'`)}getAssignedTheme(){return this._assignedTheme}setAssignedTheme(n){this._assignedTheme=n,Pt(n),this.emit("themeChanged",n)}};O=Qn([_({lifetime:"singleton"})],O);const Yn=y({shadowDomName:"shade-app-bar",constructed:({element:e})=>{requestAnimationFrame(()=>{e.style.opacity="1"})},render:({children:e,injector:t,element:n})=>{const{theme:i}=t.getInstance(O);return R(n,{style:{width:"100%",background:"rgba(128,128,128,0.2)",backdropFilter:"blur(15px)",display:"flex",justifyContent:"flex-start",alignItems:"center",boxShadow:"0 0 12px rgba(0,0,0,0.6)",transition:"opacity .35s cubic-bezier(0.550, 0.085, 0.680, 0.530), padding .2s cubic-bezier(0.550, 0.085, 0.680, 0.530)",opacity:"0",position:"fixed",zIndex:"1",color:i.text.secondary}}),c(c,null,e)}}),te=y({shadowDomName:"shade-app-bar-link",render:({children:e,props:t,useObservable:n,injector:i,element:s})=>{const o=a=>{const d=!!It(t.href,t.routingOptions)(a),l=i.getInstance(O),{theme:h}=l;return{display:"flex",height:"100%",textDecoration:"none",alignItems:"center",padding:"0 8px",transition:"color .2s ease-in-out, transform .2s ease-in-out",color:d?h.text.primary:h.text.secondary,opacity:d?"1":"0.8",transform:d?"scale(1)":"scale(0.9)",cursor:"pointer"}},[r]=n("locationChange",i.getInstance($).onLocationPathChanged);return R(s,{style:o(r)}),c(zn,{...t},e)}});var Xn=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};let z=class{constructor(){g(this,"validatedFormData",new v(null));g(this,"rawFormData",new v(null));g(this,"validationResult",new v({isValid:null}));g(this,"fieldErrors",new v({}));g(this,"inputs",new Set);g(this,"setFieldState",(t,n,i)=>{this.fieldErrors.setValue({...this.fieldErrors.getValue(),[t]:{validationResult:n,validity:i}})})}[Symbol.dispose](){this.validatedFormData[Symbol.dispose](),this.rawFormData[Symbol.dispose](),this.validationResult[Symbol.dispose]()}};z=Xn([_({lifetime:"scoped"})],z);const Kn=y({shadowDomName:"shade-form",elementBase:HTMLFormElement,elementBaseName:"form",render:({props:e,children:t,useDisposable:n,element:i,injector:s})=>{const o=n("formInjector",()=>s.createChild({owner:i}));i.injector=o;const r=new z;o.setExplicitInstance(r);const a=(d,l)=>{r.inputs.forEach(f=>{const p=document.createEvent("FocusEvent");p.initEvent("blur",!0,!0),f.dispatchEvent(p)});const h=Object.fromEntries(new FormData(d.currentTarget).entries());r.rawFormData.setValue(h);const u=r.fieldErrors.getValue();Object.values(u).some(f=>(f==null?void 0:f.validationResult.isValid)===!1)||[...r.inputs].some(f=>!f.validity.valid)?r.validationResult.setValue({isValid:!1,reason:"input-validation-failed"}):e.validate(h)?(r.validationResult.setValue({isValid:!0}),r.validatedFormData.setValue(h),l&&e.onSubmit(h)):r.validationResult.setValue({isValid:!1,reason:"validation-failed"})};return R(i,{injector:o,...e,oninvalid:d=>{a(d)},onsubmit:d=>{d.preventDefault(),a(d,!0)},onchange:d=>{a(d)},onreset:()=>{r.rawFormData.setValue(null),r.validationResult.setValue({isValid:null}),r.validatedFormData.setValue(null)}}),c(c,null,t)}}),nt=({themeProvider:e,props:t,state:n,validationResult:i})=>{var s,o,r,a;return{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",fontSize:"10px",color:t.disabled?e.theme.text.disabled:((s=n.validity)==null?void 0:s.valid)===!1||(i==null?void 0:i.isValid)===!1?e.theme.palette.error.main:n.focused?e.theme.text.primary:e.theme.text.secondary,marginBottom:"1em",padding:"1em",borderRadius:"5px",background:t.variant==="contained"?e.getRgbFromColorString(((o=n.validity)==null?void 0:o.valid)===!1||(i==null?void 0:i.isValid)===!1?e.theme.palette.error.main:e.theme.palette[t.defaultColor||"primary"].main).update("a",n.focused?.1:.2).toString():"transparent",boxShadow:t.variant==="outlined"||t.variant==="contained"?`0 0 0 1px ${((r=n.validity)==null?void 0:r.valid)===!1||(i==null?void 0:i.isValid)===!1?e.theme.palette.error.main:n.focused?e.theme.palette[t.defaultColor||"primary"].main:e.theme.text.primary}`:"none",filter:t.disabled?"grayscale(100%)":"none",opacity:t.disabled?"0.5":"1",transition:"color 0.2s ease-in-out, filter 0.2s ease-in-out, opacity 0.2s ease-in-out, border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out",...(a=t.labelProps)==null?void 0:a.style}},Zn=e=>{if(!e.valid){if(e.valueMissing)return"Value is required";if(e.typeMismatch)return"Value is not valid";if(e.patternMismatch)return"Value does not match the pattern";if(e.tooLong)return"Value is too long";if(e.tooShort)return"Value is too short";if(e.rangeUnderflow)return"Value is too low";if(e.rangeOverflow)return"Value is too high";if(e.stepMismatch)return"Value is not a valid step";if(e.badInput)return"Value is not valid"}},Tt=y({shadowDomName:"shade-input",constructed:({injector:e,element:t})=>{if(e.cachedSingletons.has(z)){const n=t.querySelector("input"),i=e.getInstance(z);return i.inputs.add(n),()=>i.inputs.delete(n)}},render:({props:e,injector:t,useObservable:n,element:i})=>{var d,l,h;const s=t.getInstance(O),o=u=>{var k,L,K,Z,G;const f=i.querySelector("label"),p=i.querySelector("input");u.value=(p==null?void 0:p.value)||u.value,u.validity=(p==null?void 0:p.validity)||u.validity,u.validity.toJSON=()=>({valid:u.validity.valid,valueMissing:u.validity.valueMissing,typeMismatch:u.validity.typeMismatch,patternMismatch:u.validity.patternMismatch,tooLong:u.validity.tooLong,tooShort:u.validity.tooShort,rangeUnderflow:u.validity.rangeUnderflow,rangeOverflow:u.validity.rangeOverflow,stepMismatch:u.validity.stepMismatch,badInput:u.validity.badInput});const m=(k=e.getValidationResult)==null?void 0:k.call(e,{state:u});(m==null?void 0:m.isValid)===!1||((L=u.validity)==null?void 0:L.valid)===!1?i.setAttribute("data-validation-failed","true"):i.removeAttribute("data-validation-failed"),P(f,{style:nt({themeProvider:s,props:e,state:u,validationResult:m})});const S=i.querySelector("span.helperText"),w=(m==null?void 0:m.isValid)===!1&&(m==null?void 0:m.message)||((K=e.getHelperText)==null?void 0:K.call(e,{state:u,validationResult:m}))||Zn(u.validity)||"";S==null||S.replaceChildren(w);const x=i.querySelector("span.startIcon");x==null||x.replaceChildren(((Z=e.getStartIcon)==null?void 0:Z.call(e,{state:u,validationResult:m}))||"");const D=i.querySelector("span.endIcon");D==null||D.replaceChildren(((G=e.getEndIcon)==null?void 0:G.call(e,{state:u,validationResult:m}))||""),t.cachedSingletons.has(z)&&t.getInstance(z).setFieldState(e.name,m||{isValid:!0},u.validity)},[r,a]=n("inputState",new v({value:e.value||"",focused:e.autofocus||!1,validity:((d=i.querySelector("input"))==null?void 0:d.validity)||{},element:i}),{onChange:o});return c("label",{...e.labelProps,style:nt({props:e,state:r,themeProvider:s})},e.labelTitle,c("div",{style:{display:"flex",alignItems:"center",width:"100%"}},e.getStartIcon?c("span",{className:"startIcon"},(l=e.getStartIcon)==null?void 0:l.call(e,{state:r})):null,c("input",{oninvalid:u=>{u.preventDefault();const f=u.target;a({...r,validity:f.validity})},onchange:function(u){var m,S;const f=u.target,p=f.value;a({...r,value:p,validity:f==null?void 0:f.validity}),(m=e.onTextChange)==null||m.call(e,p),(S=e==null?void 0:e.onchange)==null||S.call(this,u)},onfocus:u=>{const f=u.target;a({...r,focused:!0,validity:f.validity})},onblur:u=>{const f=u.target;a({...r,focused:!1,validity:f.validity})},...e,style:{color:"inherit",border:"none",backgroundColor:"transparent",outline:"none",fontSize:"12px",width:"100%",textOverflow:"ellipsis",padding:"0",marginTop:"0.6em",marginBottom:"0.4em",flexGrow:"1",...e.style},value:r.value}),e.getEndIcon?c("span",{className:"endIcon"},e.getEndIcon({state:r})):null),c("span",{className:"helperText"},(h=e.getHelperText)==null?void 0:h.call(e,{state:r})))}});y({shadowDomName:"shade-autocomplete",constructed({element:e,useState:t}){var i;const[n]=t("dataListId",(Math.random()+1).toString(36).substring(3));(i=e.querySelector("input"))==null||i.setAttribute("list",n)},render:({props:e,useState:t})=>{const[n]=t("dataListId",(Math.random()+1).toString(36).substring(3));return c(c,null,c(Tt,{...e.inputProps,onchange:i=>{var o;const{value:s}=i.target;if(e.strict&&!e.suggestions.includes(s)){i.target.setCustomValidity("Please select a valid entry!");return}(o=e.onchange)==null||o.call(e,s)}}),c("datalist",{id:n},e.suggestions.map(i=>c("option",{value:i}))))}});y({shadowDomName:"shade-text-area",render:({props:e,element:t,injector:n})=>{var r;const i=n.getInstance(O),{theme:s}=i,{palette:o}=s;return c("label",{...e.labelProps,style:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",fontSize:"10px",color:e.disabled?"rgb(170, 170, 170)":"#bbb",marginBottom:"1em",padding:"1em",borderRadius:"5px",border:e.variant==="outlined"?"1px solid #bbb":"none",...(r=e.labelProps)==null?void 0:r.style}},c("span",null,e.labelTitle),c("div",{contentEditable:e.readOnly===!0||e.disabled===!0?"inherit":"true",...e,style:{border:"none",backgroundColor:"transparent",outline:"none",fontSize:"12px",width:"100%",textOverflow:"ellipsis",...e.style},onfocus:()=>{e.disabled||(b(t.querySelector("label"),[{color:i.getTextColor(s.background.default)},{color:o.primary.main}],{duration:500,easing:"cubic-bezier(0.455, 0.030, 0.515, 0.955)",fill:"forwards"}),b(t.querySelector('div[contenteditable="true"]'),[{boxShadow:"0px 0px 0px rgba(128,128,128,0.1)"},{boxShadow:`0px 3px 0px ${o.primary.main}`}],{duration:200,fill:"forwards"}))},onblur:()=>{e.disabled||(b(t.querySelector("label"),[{color:o.primary.main},{color:i.getTextColor(s.background.default)}],{duration:200,easing:"cubic-bezier(0.455, 0.030, 0.515, 0.955)",fill:"forwards"}),b(t.querySelector('div[contenteditable="true"]'),[{boxShadow:"0px 3px 0px rgba(128,128,128,0.4)"},{boxShadow:"0px 0px 0px rgba(128,128,128,0.1)"}],{duration:400,fill:"forwards"}))}},e.value))}});y({shadowDomName:"shade-avatar",render:({props:e,element:t})=>{const{avatarUrl:n,...i}=e;return R(t,{...i,style:{width:"128px",height:"128px",overflow:"hidden",borderRadius:"50%",boxShadow:"0px 0px 8px 3px rgba(128,128,128,0.2)",backgroundColor:"rgba(128,128,128,0.3)",display:"flex",...i==null?void 0:i.style}}),c("img",{style:{width:"100%",height:"100%",objectFit:"cover",backgroundPosition:"center"},alt:"avatar image",src:e.avatarUrl,onerror:s=>{s.target.replaceWith(c("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%"}},c("div",{style:{textAlign:"center",userSelect:"none",fontSize:"32px"}},e.fallback||"🛑")))}})}});const ei=(e,t)=>e.variant==="contained"?e.color?e.disabled?t.palette[e.color].dark:t.palette[e.color].main:e.disabled?t.button.disabledBackground:t.text.primary:"rgba(0,0,0,0)",ti=(e,t,n)=>e.variant==="contained"?e.color?t.palette[e.color].dark:e.disabled?t.button.disabledBackground:t.text.secondary:n(),ni=(e,t)=>e.variant==="outlined"?e.color?`0px 0px 0px 1px ${e.disabled?t.palette[e.color].dark:t.palette[e.color].main}`:`0px 0px 0px 1px ${e.disabled?t.button.disabledBackground:t.text.secondary}`:"none",ii=(e,t)=>e.variant==="outlined"?e.color?`0px 0px 0px 1px ${e.disabled?t.button.disabledBackground:t.palette[e.color].light}`:`0px 0px 0px 1px ${e.disabled?t.button.disabledBackground:t.text.primary}`:"none",it=(e,t,n)=>e.variant!=="contained"?e.color?e.disabled?t.palette[e.color].dark:t.palette[e.color].main:t.text.secondary:n(),si=(e,t,n)=>e.variant!=="contained"?e.color?e.disabled?t.palette[e.color].dark:t.palette[e.color].light:t.text.primary:n(),q=y({shadowDomName:"shade-button",elementBase:HTMLButtonElement,elementBaseName:"button",constructed:({element:e})=>{function t(n){n.target===e&&b(e,[{filter:"drop-shadow(1px 1px 10px rgba(0,0,0,.5))brightness(1)",transform:"scale(1)"}],{duration:350,fill:"forwards",easing:"cubic-bezier(0.230, 1.000, 0.320, 1.000)"})}return document.addEventListener("mouseup",t),()=>{document.removeEventListener("mouseup",t)}},render:({props:e,children:t,injector:n,element:i,useDisposable:s})=>{const o=e.onmousedown,r=e.onmouseup,a=n.getInstance(O),{theme:d}=a,l=ei(e,d);e.variant==="contained"&&s("themeChanged",()=>a.subscribe("themeChanged",()=>{const w=i;w.style.color=it(e,a.theme,()=>a.getTextColor(w.style.background||w.style.backgroundColor))}));const h=ti(e,d,()=>{const{r:w,g:x,b:D}=a.getRgbFromColorString(e.color&&d.palette[e.color].main||d.text.primary);return`rgba(${w}, ${x}, ${D}, 0.1)`}),u=ni(e,d),f=ii(e,d),p=()=>it(e,d,()=>a.getTextColor(l)),m=()=>si(e,d,()=>a.getTextColor(l)),S=async(w,x)=>{i&&b(i,w,x)};return R(i,{...e,onmousedown(w){o==null||o.call(this,w),S([{filter:"drop-shadow(-1px -1px 3px black)brightness(0.5)",transform:"scale(0.98)"}],{duration:150,fill:"forwards",easing:"cubic-bezier(0.230, 1.000, 0.320, 1.000)"})},onmouseup(w){r==null||r.call(this,w)},onmouseenter:()=>{S([{background:l,boxShadow:u,color:p()},{background:h,boxShadow:f,color:m()}],{duration:500,fill:"forwards",easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"})},onmouseout:()=>{S([{background:h,boxShadow:f,color:m()},{background:l,boxShadow:u,color:p()}],{duration:500,fill:"forwards",easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"})},...e,style:{display:"inline-flex",cursor:e.disabled?"not-allowed":"pointer",background:l,boxShadow:u,margin:"8px",padding:"6px 16px",border:"none",borderRadius:"4px",textTransform:"uppercase",color:p(),filter:"drop-shadow(1px 1px 10px rgba(0,0,0,.5))",backdropFilter:e.variant==="outlined"?"blur(35px)":void 0,userSelect:"none",...e.style}}),c(c,null,t)}}),oi=y({shadowDomName:"data-grid-order-button",render:({props:e,useObservable:t})=>{const[n,i]=t("findOptions",e.findOptions,{}),s=Object.keys(n.order||{})[0],o=Object.values(n.order||{})[0];return c(q,{title:"Change order",style:{padding:"4px",margin:"0",cursor:"pointer"},color:s===e.field?"info":void 0,onclick:r=>{r.stopPropagation();let a="ASC";const d={};s===e.field&&(a=o==="ASC"?"DESC":"ASC"),d[e.field]=a,i({...n,order:d})}},s===e.field&&(o==="ASC"?"⬇":"⬆")||"↕")}}),ri=y({shadowDomName:"data-grid-search-button",render:({props:e,useObservable:t})=>{var s,o;const[n]=t("currentValue",e.findOptions,{filter:r=>{var a;return!!((a=r.filter)!=null&&a[e.fieldName])}}),i=((o=(s=n.filter)==null?void 0:s[e.fieldName])==null?void 0:o.$regex)||"";return c(q,{type:"button",title:"Filter",style:{padding:"4px",margin:"0",cursor:"pointer"},onclick:e.onclick},i?"🔍":"🔎")}}),ai=y({shadowDomName:"data-grid-search-form",render:({props:e,useObservable:t})=>{var s,o;const[n]=t("currentValue",e.findOptions,{filter:(r,a)=>{var h,u;const d=(h=r.filter)==null?void 0:h[e.fieldName],l=(u=a.filter)==null?void 0:u[e.fieldName];return(d==null?void 0:d.$regex)!==(l==null?void 0:l.$regex)}}),i=((o=(s=n.filter)==null?void 0:s[e.fieldName])==null?void 0:o.$regex)||"";return c(Kn,{className:"search-form",style:{display:"flex",width:"100%",overflow:"hide",height:"0px",justifyContent:"space-around",opacity:"0"},validate:r=>{var a;return typeof((a=r.searchValue)==null?void 0:a.length)=="number"},onSubmit:({searchValue:r})=>{e.onSubmit(r)}},c(Tt,{style:{padding:"0px",paddingBottom:"0",margin:"0"},placeholder:e.fieldName,autofocus:!0,labelTitle:`${e.fieldName}`,name:"searchValue",value:typeof i=="string"?i:"",labelProps:{style:{padding:"0px 2em"}}}),c("div",{style:{display:"flex",width:"64px",alignItems:"center",justifyContent:"center",gap:"8px"}},c(q,{type:"reset",style:{padding:"4px",margin:"0"},onclick:r=>{r.preventDefault(),r.stopPropagation(),e.onClear()}},"❌"),c(q,{style:{padding:"4px",margin:"0"},type:"submit"},"🔎")))}}),li=y({shadowDomName:"data-grid-header",render:({props:e,element:t,useObservable:n})=>{const[,i]=n("isSearchOpened",new v(!1),{onChange:a=>{const d=t.querySelector(".search-form"),l=t.querySelector(".header-content");a?(d.style.display="flex",tt(d).then(async()=>{var h;await Ut(100),(h=d.querySelector("input"))==null||h.focus()}),et(l)):(et(d),tt(l))}}),[s,o]=n("findOptions",e.findOptions),r=a=>{if(a){const d={...s,filter:{...s.filter,[e.field]:{$regex:a}}};o(d)}else{const{[e.field]:d,...l}=s.filter||{};o({...s,filter:l})}i(!1)};return c(c,null,c(ai,{onSubmit:r,onClear:r,fieldName:e.field,findOptions:e.findOptions}),c("div",{className:"header-content",style:{display:"flex",width:"100%",height:"48px",justifyContent:"space-between",alignItems:"center",gap:"8px",overflow:"hide"}},c("div",{style:{paddingLeft:"0.5em"}},e.field),c("div",{className:"header-controls",style:{display:"flex",justifyContent:"center",alignItems:"center",paddingRight:"0.5em"}},c(ri,{onclick:()=>{i(!0)},findOptions:e.findOptions,fieldName:e.field}),c(oi,{field:e.field,findOptions:e.findOptions}))))}}),ci=y({shadowDomName:"shades-data-grid-row",render:({props:e,element:t,useObservable:n,injector:i})=>{const{entry:s,rowComponents:o,columns:r,service:a}=e,{theme:d}=i.getInstance(O),l=p=>{p.includes(s)?(t.classList.add("selected"),P(t,{style:e.selectedRowStyle||{backgroundColor:d.background.default}}),t.setAttribute("aria-selected","true")):(t.classList.remove("selected"),P(t,{style:e.unselectedRowStyle||{backgroundColor:"transparent"}}),t.setAttribute("aria-selected","false"))},h=p=>{var m,S,w,x;if(p===e.entry){P(t,{style:e.focusedRowStyle||{boxShadow:"0 0 50px 1px rgba(255,255,255,0.2) inset, 0 0 35px 1px var(--shades-theme-palette-primary-main) inset, 2px 0px 5px 0px rgba(0,0,0,0.3)",transition:"box-shadow 0.1s ease-in-out",fontWeight:"bolder"}}),t.classList.add("focused");const D=((S=(m=t.closest("table"))==null?void 0:m.querySelector("th"))==null?void 0:S.getBoundingClientRect().height)||42,k=t.closest(".shade-grid-wrapper"),L=t.offsetTop-D,K=k.scrollTop;L<K&&k.scrollTo({top:L,behavior:"smooth"});const Z=((x=(w=t.closest("shade-data-grid"))==null?void 0:w.querySelector("shade-data-grid-footer"))==null?void 0:x.getBoundingClientRect().height)||42,G=k.clientHeight-Z,ve=t.offsetTop+t.clientHeight;ve>G&&k.scrollTo({top:ve-G,behavior:"smooth"})}else t.classList.remove("focused"),P(t,{style:e.unfocusedRowStyle||{boxShadow:"none",fontWeight:"inherit"}})},[u]=n("isSelected",a.selection,{onChange:l});l(u);const[f]=n("focus",a.focusedEntry,{onChange:h});return h(f),t.style.display="table-row",t.style.cursor="default",t.style.userSelect="none",u!=null&&u.includes(s)&&(t.setAttribute("aria-selected","true"),t.classList.add("selected")),f===s&&t.classList.add("focused"),t.setAttribute("aria-selected",(u==null?void 0:u.includes(s).toString())||"false"),c(c,null,r.map(p=>{var m,S;return c("td",{style:{padding:"0.5em"},onclick:w=>{var x;return(x=e.onRowClick)==null?void 0:x.call(e,s,w)},ondblclick:w=>{var x;return(x=e.onRowDoubleClick)==null?void 0:x.call(e,s,w)}},((m=o==null?void 0:o[p])==null?void 0:m.call(o,s,{selection:u,focus:f}))||((S=o==null?void 0:o.default)==null?void 0:S.call(o,s,{selection:u,focus:f}))||c("span",null,s[p]))}))}}),di=y({shadowDomName:"shade-data-grid-body",elementBase:HTMLTableSectionElement,elementBaseName:"tbody",style:{display:"table-row-group"},render:({props:e,useObservable:t})=>{var i,s;const[n]=t("data",e.service.data);return(i=n==null?void 0:n.entries)!=null&&i.length?c(c,null,(s=n==null?void 0:n.entries)==null?void 0:s.map(o=>c(ci,{columns:e.columns,entry:o,service:e.service,rowComponents:e.rowComponents,onRowClick:e.onRowClick,onRowDoubleClick:e.onRowDoubleClick,focusedRowStyle:e.focusedRowStyle,unfocusedRowStyle:e.unfocusedRowStyle,selectedRowStyle:e.selectedRowStyle,unselectedRowStyle:e.unselectedRowStyle}))):e.emptyComponent||c("div",null," - No Data - ")}}),ui=[10,20,25,50,100,1/0],fi=y({shadowDomName:"shade-data-grid-footer",render:({props:e,injector:t,useObservable:n})=>{const{theme:i}=t.getInstance(O),{service:s,findOptions:o}=e,[r]=n("dataUpdater",s.data),[a,d]=n("optionsUpdater",o,{filter:(p,m)=>p.top!==m.top||p.skip!==m.skip}),l=a.top||1/0,h=a.skip||0,u=Math.ceil(h)/(l||1),f=l;return c("div",{className:"pager",style:{backdropFilter:"blur(10px)",color:i.text.secondary,position:"sticky",bottom:"0",display:"flex",justifyContent:"flex-end",padding:"1em",alignItems:"center"}},f!==1/0&&c("div",null,"Goto page",c("select",{style:{margin:"0 1em"},onchange:p=>{const m=parseInt(p.target.value,10);d({...a,skip:(a.top||0)*m})}},[...new Array(Math.ceil(r.count/(a.top||1/0)))].map((p,m)=>c("option",{value:m.toString(),selected:u===m},(m+1).toString())))),c("div",null,"Show",c("select",{style:{margin:"0 1em"},onchange:p=>{const m=parseInt(p.currentTarget.value,10);d({...a,top:m,skip:u*m})}},ui.map(p=>c("option",{value:p.toString(),selected:p===f},p.toString()))),"items per page"))}});class jt{constructor(t,n){g(this,"element");g(this,"onClickAway");g(this,"clickOutsideListener",(t=>{t.target&&!this.element.contains(t.target)&&this.onClickAway()}).bind(this));this.element=t,this.onClickAway=n,window.addEventListener("click",this.clickOutsideListener,!0)}[Symbol.dispose](){window.removeEventListener("click",this.clickOutsideListener,!0)}}y({shadowDomName:"shade-data-grid",constructed:({props:e})=>{const t=n=>e.collectionService.handleKeyDown(n);return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},render:({props:e,injector:t,useDisposable:n,element:i})=>{var a,d,l;const s=t.getInstance(O),{theme:o}=s;n("clickAway",()=>new jt(i,()=>{e.collectionService.hasFocus.setValue(!1)}));const r={backdropFilter:"blur(12px) saturate(180%)",background:"rgba(128,128,128,0.3)",color:o.text.secondary,height:"38px",alignItems:"center",borderRadius:"2px",top:"2px",position:"sticky",fontVariant:"all-petite-caps",zIndex:"1",boxShadow:"rgba(0, 0, 0, 0.2) 1px 1px 1px 2px",...(a=e.styles)==null?void 0:a.header};return c("div",{className:"shade-grid-wrapper",style:{...(d=e.styles)==null?void 0:d.wrapper,width:"100%",height:"100%",overflow:"auto",zIndex:"1"},onclick:()=>{e.collectionService.hasFocus.setValue(!0)},ariaMultiSelectable:"true"},c("table",{style:{width:"100%",maxHeight:"calc(100% - 4em)",position:"relative"}},c("thead",null,c("tr",null,e.columns.map(h=>{var u,f,p,m;return c("th",{style:r},((f=(u=e.headerComponents)==null?void 0:u[h])==null?void 0:f.call(u,h))||((m=(p=e.headerComponents)==null?void 0:p.default)==null?void 0:m.call(p,h))||c(li,{field:h,findOptions:e.findOptions}))}))),c(di,{columns:e.columns,service:e.collectionService,rowComponents:e.rowComponents,onRowClick:(h,u)=>e.collectionService.handleRowClick(h,u),onRowDoubleClick:h=>e.collectionService.handleRowDoubleClick(h),style:(l=e.styles)==null?void 0:l.cell,focusedRowStyle:e.focusedRowStyle,selectedRowStyle:e.selectedRowStyle,unfocusedRowStyle:e.unfocusedRowStyle,unselectedRowStyle:e.unselectedRowStyle,emptyComponent:e.emptyComponent,loaderComponent:e.loaderComponent})),c(fi,{service:e.collectionService,findOptions:e.findOptions}))}});y({shadowDomName:"shades-data-grid-selection-cell",render:({props:e,useObservable:t,element:n})=>{const[i]=t("selection",e.service.selection,{onChange:o=>{n.querySelector("input").checked=o.includes(e.entry)}}),s=i.includes(e.entry);return c("input",{onchange:()=>{e.service.toggleSelection(e.entry)},type:"checkbox",checked:s})}});y({shadowDomName:"shade-fab",elementBase:HTMLButtonElement,elementBaseName:"button",style:{position:"fixed",bottom:"32px",right:"32px",background:"gray",width:"64px",height:"64px",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"50%",boxShadow:"2px 2px 4px rgba(0,0,0,0.3)",cursor:"pointer"},render:({children:e})=>c(c,null,e)});y({shadowDomName:"shade-grid",render:({props:e,injector:t})=>{var s,o;const{theme:n}=t.getInstance(O),i={padding:"0 0.51em",backgroundColor:n.background.paper,color:n.text.secondary,borderRadius:"2px",top:"0",position:"sticky",cursor:"pointer",fontVariant:"all-petite-caps",...(s=e.styles)==null?void 0:s.header};return c("div",{className:"shade-grid-wrapper",style:{...(o=e.styles)==null?void 0:o.wrapper,width:"100%",height:"100%",overflow:"auto"}},c("table",{style:{width:"100%",position:"relative"}},c("thead",null,c("tr",null,e.columns.map(r=>{var a,d,l,h;return c("th",{style:i},((d=(a=e.headerComponents)==null?void 0:a[r])==null?void 0:d.call(a,r))||((h=(l=e.headerComponents)==null?void 0:l.default)==null?void 0:h.call(l,r))||c(c,null,r))}))),c("tbody",null,e.entries.map(r=>c("tr",null,e.columns.map(a=>{var d,l,h,u,f;return c("td",{style:(d=e.styles)==null?void 0:d.cell},((h=(l=e.rowComponents)==null?void 0:l[a])==null?void 0:h.call(l,r,a))||((f=(u=e.rowComponents)==null?void 0:u.default)==null?void 0:f.call(u,r,a))||null)}))))))}});y({shadowDomName:"shade-modal",render:({props:e,children:t,useObservable:n,element:i})=>{var o;const[s]=n("isVisible",e.isVisible);return s&&((o=e.showAnimation)==null||o.call(e,i)),s?c("div",{className:"shade-backdrop",onclick:async()=>{var r,a;await((r=e.hideAnimation)==null?void 0:r.call(e,i)),(a=e.onClose)==null||a.call(e)},style:{width:"100%",height:"100%",display:"block",position:"fixed",top:"0",left:"0",...e.backdropStyle}},t):null}});var hi=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},gi=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)};let he=class extends Re{constructor(){super();g(this,"notyList",[]);g(this,"getNotyList",()=>[...this.notyList]);this.addListener("onNotyAdded",this.onNotyAddListener.bind(this)),this.addListener("onNotyRemoved",this.onNotyRemoveListener.bind(this))}onNotyAddListener(n){this.notyList=[...this.notyList,n]}onNotyRemoveListener(n){this.notyList=this.notyList.filter(i=>i!==n)}[Symbol.dispose](){var n;this.notyList=[],this.removeListener("onNotyAdded",this.onNotyAddListener.bind(this)),this.removeListener("onNotyRemoved",this.onNotyRemoveListener.bind(this)),(n=super[Symbol.dispose])==null||n.call(this)}};he=hi([_({lifetime:"singleton"}),gi("design:paramtypes",[])],he);const pi=e=>{switch(e){case"error":return 0;case"warning":return 0;case"success":return 5e3;case"info":return 2e4;default:return 0}},st=y({shadowDomName:"shade-noty",constructed:({element:e})=>{setTimeout(()=>{const t=e.scrollHeight||80;b(e,[{opacity:"0",height:"0px"},{opacity:"1",height:`${t}px`}],{fill:"forwards",duration:700,easing:"cubic-bezier(0.190, 1.000, 0.220, 1.000)"})})},style:{margin:"8px",overflow:"hidden",borderRadius:"6px",boxShadow:"1px 3px 6px rgba(0,0,0,0.3)",width:"300px",display:"flex",flexDirection:"column",height:"0px"},render:({props:e,injector:t,element:n})=>{const i=t.getInstance(O),s=i.theme.palette[e.model.type],o=i.getTextColor(s.dark),r=i.getTextColor(s.main),a=async()=>{await b(n,[{opacity:"1",height:`${(n==null?void 0:n.scrollHeight)||0}px`,margin:"8px 8px"},{opacity:"0",height:"0px",margin:"0px 8px"}],{fill:"forwards",duration:700,easing:"cubic-bezier(0.190, 1.000, 0.220, 1.000)"}),e.onDismiss()},d=e.model.timeout||pi(e.model.type);return d&&setTimeout(()=>void a(),d),n.className=`noty ${e.model.type}`,n.style.backgroundColor=s.main,n.style.color=r,c(c,null,c("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px 6px 0px 16px",backgroundColor:s.dark,color:o,fontSize:"1.3em"}},c("h5",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",margin:"0",fontSize:".7em"},title:e.model.title},e.model.title),c(q,{style:{margin:"4px 0",padding:"0 4px",fontSize:"12px"},className:"dismissNoty",onclick:a,title:"Close Notification",variant:"contained",color:e.model.type},"✖")),c("div",{style:{padding:"16px 16px"}},e.model.body))}});y({shadowDomName:"shade-noty-list",style:{position:"fixed",bottom:"1em",right:"1em",display:"flex",flexDirection:"column"},render:({useDisposable:e,injector:t,element:n})=>{const i=t.getInstance(he),s=i.getNotyList();return e("addNoty",()=>i.subscribe("onNotyAdded",o=>n.append(c(st,{model:o,onDismiss:()=>i.emit("onNotyRemoved",o)})))),e("removeNoty",()=>i.subscribe("onNotyRemoved",o=>{n.querySelectorAll("shade-noty").forEach(r=>{r.props.model===o&&r.remove()})})),c(c,null,s.map(o=>c(st,{model:o,onDismiss:()=>t.getInstance(he).emit("onNotyRemoved",o)})))}});const mi=y({shadowDomName:"shade-paper",elementBase:HTMLDivElement,elementBaseName:"div",style:{borderRadius:"3px",margin:"8px",padding:"6px 16px"},render:({injector:e,props:t,children:n,element:i})=>{const s=e.getInstance(O),{elevation:o=1}=t;return P(i,{style:{boxShadow:o?`1px ${o}px ${o}px rgba(0,0,0,0.3)`:"",backgroundColor:s.theme.background.paper,color:s.theme.text.secondary}}),c(c,null,n)}});y({shadowDomName:"shade-skeleton",style:{opacity:"0",display:"inline-block",background:"linear-gradient(-45deg, rgba(128,128,128,0.1), rgba(128,128,128,0.3), rgba(128,128,128,0.1))",backgroundSize:"400% 400%",width:"100%",height:"100%",minHeight:"1em"},render:({element:e,props:t})=>{const{delay:n=1500}=t;return setTimeout(()=>{b(e,[{opacity:0},{opacity:1}],{fill:"forwards",duration:300,easing:"ease-out",delay:n}).then(()=>{b(e,[{backgroundPosition:"0% 50%"},{backgroundPosition:"100% 50%"},{backgroundPosition:"0% 50%"}],{duration:1e4,iterations:1/0})})}),null}});const Vt=y({shadowDomName:"shade-loader",style:{display:"inline-block",transformOrigin:"center",opacity:"0"},render:({element:e,props:t,injector:n})=>{const{theme:i}=n.getInstance(O),{delay:s=500}=t,{borderWidth:o=15}=t,{borderColor:r=i.palette.primary.main}=t;return setTimeout(()=>{b(e,[{opacity:"0"},{opacity:"1"}],{duration:500,delay:s,fill:"forwards"}),b(e.firstElementChild,[{transform:"rotate(0deg)"},{transform:"rotate(180deg)"},{transform:"rotate(360deg)"}],{duration:1500,easing:"ease-in-out",iterations:1/0})},1),c("div",{style:{position:"relative",width:`calc(100% - ${o*2}px)`,height:`calc(100% - ${o*2}px)`,border:`${o}px solid rgba(128,128,128,0.1)`,borderBottom:`${o}px solid ${r}`,borderRadius:"50%"}})}}),yi=y({shadowDomName:"shades-suggest-input",style:{width:"100%",overflow:"hidden"},render:({element:e,props:t,useObservable:n,injector:i})=>{const{theme:s}=i.getInstance(O);return n("isOpened",t.manager.isOpened,{onChange:o=>{const r=e.firstChild;o?r.focus():r.value=""}}),c("input",{autofocus:!0,style:{color:s.text.primary,outline:"none",padding:"1em",background:"transparent",border:"none",display:"inline-flex",width:"calc(100% - 2em)"}})}});var bi=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},vi=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)};let _e=class extends Re{constructor(n,i){super();g(this,"getEntries");g(this,"getSuggestionEntry");g(this,"isOpened",new v(!1));g(this,"isLoading",new v(!1));g(this,"term",new v(""));g(this,"selectedIndex",new v(0));g(this,"currentSuggestions",new v([]));g(this,"keyPressListener",(n=>{n.key==="Escape"&&this.isOpened.setValue(!1)}).bind(this));g(this,"element");g(this,"clickOutsideListener",(n=>{this.element&&this.isOpened.getValue()&&n.target.closest(this.element.tagName)!==this.element&&this.isOpened.setValue(!1)}).bind(this));g(this,"lastGetSuggestionOptions");g(this,"getSuggestion",vt(async n=>{var i;try{if(((i=this.lastGetSuggestionOptions)==null?void 0:i.term)===n.term)return;const s=JSON.stringify(this.currentSuggestions.getValue()[this.selectedIndex.getValue()]);this.isLoading.setValue(!0),this.lastGetSuggestionOptions=n;const o=await this.getEntries(n.term);this.isOpened.setValue(!0),this.currentSuggestions.setValue(o.map(r=>({entry:r,suggestion:this.getSuggestionEntry(r)}))),this.selectedIndex.setValue(Math.max(0,this.currentSuggestions.getValue().findIndex(r=>JSON.stringify(r)===s)))}finally{this.isLoading.setValue(!1)}},250));this.getEntries=n,this.getSuggestionEntry=i,window.addEventListener("keyup",this.keyPressListener,!0),window.addEventListener("click",this.clickOutsideListener,!0)}[Symbol.dispose](){window.removeEventListener("keyup",this.keyPressListener,!0),window.removeEventListener("click",this.clickOutsideListener,!0),this.isOpened[Symbol.dispose](),this.isLoading[Symbol.dispose](),this.term[Symbol.dispose](),this.selectedIndex[Symbol.dispose](),this.currentSuggestions[Symbol.dispose](),super[Symbol.dispose]()}selectSuggestion(n=this.selectedIndex.getValue()){const i=this.currentSuggestions.getValue()[n];this.isOpened.setValue(!1),this.emit("onSelectSuggestion",i.entry)}};_e=bi([_({lifetime:"singleton"}),vi("design:paramtypes",[Function,Function])],_e);const wi=y({shadowDomName:"shade-suggest-suggestion-list",render:({element:e,props:t,injector:n,useObservable:i})=>{var l;const{manager:s}=t,{theme:o}=n.getInstance(O),[r]=i("suggestions",s.currentSuggestions),[a]=i("selectedIndex",s.selectedIndex,{onChange:h=>{[...e.querySelectorAll(".suggestion-item")].map((u,f)=>{f===h?(u.style.background=o.background.paper,u.style.fontWeight="bolder"):(u.style.background=o.background.default,u.style.fontWeight="normal")})}}),[d]=i("isOpened",s.isOpened,{onChange:h=>{var f;const u=e.firstElementChild;h?(u.style.zIndex="1",u.style.width=`calc(${Math.round(((f=e.parentElement)==null?void 0:f.getBoundingClientRect().width)||200)}px - 3em)`,b(u,[{opacity:0,transform:"translate(0, -50px)"},{opacity:1,transform:"translate(0, 0)"}],{fill:"forwards",duration:500})):(b(u,[{opacity:1,transform:"translate(0, 0)"},{opacity:0,transform:"translate(0, -50px)"}],{fill:"forwards",duration:200}),u.style.zIndex="-1")}});return c("div",{className:"suggestion-items-container",style:{borderTop:"none",position:"absolute",borderRadius:"0px 0px 5px 5px",marginLeft:"14px",overflow:"hidden",zIndex:"1",left:"auto",backgroundColor:o.background.paper,color:o.text.secondary,boxShadow:"3px 3px 5px rgba(0,0,0,0.3)",backdropFilter:"blur(15px)",width:`calc(${Math.round(((l=e.parentElement)==null?void 0:l.getBoundingClientRect().width)||200)}px - 3em)`}},r.map((h,u)=>c("div",{className:"suggestion-item",onclick:()=>{d&&s.selectSuggestion(u)},style:{padding:"1em",cursor:"default",background:u===a?o.background.paper:o.background.default,fontWeight:u===a?"bolder":"normal"}},h.suggestion.element)))}});y({shadowDomName:"shade-suggest",style:{flexGrow:"1"},render:({props:e,injector:t,element:n,useDisposable:i})=>{const s=i("manager",()=>new _e(e.getEntries,e.getSuggestionEntry)),{theme:o}=t.getInstance(O);return s.element=n,s.isOpened.subscribe(r=>{const a=n.querySelector(".input-container"),d=n.querySelector(".close-suggestions"),l=n.querySelector(".post-controls");r?(b(d,[{opacity:0},{opacity:1}],{duration:500,fill:"forwards"}),b(l,[{width:"0px"},{width:"50px"}],{duration:100,fill:"forwards"}),b(a,[{background:"transparent"},{background:o.background.default}],{duration:500,fill:"forwards",easing:"cubic-bezier(0.050, 0.570, 0.840, 1.005)"})):(b(d,[{opacity:1},{opacity:0}],{duration:500,fill:"forwards"}),b(l,[{width:"50px"},{width:"0px"}],{duration:500,fill:"forwards",delay:300}),b(a,[{background:o.background.default},{background:"transparent"}],{duration:300,fill:"forwards",easing:"cubic-bezier(0.000, 0.245, 0.190, 0.790)"}))}),s.isLoading.subscribe(r=>{const a=n.querySelector("shade-loader");r?b(a,[{opacity:0},{opacity:1}],{duration:100,fill:"forwards"}):b(a,[{opacity:1},{opacity:0}],{duration:100,fill:"forwards"})}),i("onSelectSuggestion",()=>s.subscribe("onSelectSuggestion",e.onSelectSuggestion)),c("div",{style:{display:"flex",flexDirection:"column"},onkeyup:r=>{if(r.key==="Enter"){r.preventDefault(),s.selectSuggestion();return}r.key==="ArrowUp"&&(r.preventDefault(),s.selectedIndex.setValue(Math.max(0,s.selectedIndex.getValue()-1))),r.key==="ArrowDown"&&(r.preventDefault(),s.selectedIndex.setValue(Math.min(s.selectedIndex.getValue()+1,s.currentSuggestions.getValue().length-1))),s.getSuggestion({injector:t,term:r.target.value})}},c("div",{className:"input-container",style:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 1em",borderRadius:"5px",position:"relative",background:"rgba(128,128,128,0.1)",...e.style}},c("div",{className:"term-icon",style:{cursor:"pointer",color:"#aaa",fontWeight:"bolder",textShadow:"0 0 1px #aaa"},onclick:()=>s.isOpened.setValue(!0)},e.defaultPrefix),c(yi,{manager:s}),c("div",{className:"post-controls",style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:s.isOpened.getValue()?"50px":"0px",overflow:"hidden"}},c(Vt,{style:{width:"20px",height:"20px",opacity:s.isLoading.getValue()?"1":"0"},delay:0,borderWidth:4}),c("div",{className:"close-suggestions",onclick:()=>s.isOpened.setValue(!1),style:{width:"20px",height:"20px",opacity:s.isOpened.getValue()?"1":"0",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}},"✖"))),c(wi,{manager:s}))}});const xi=y({shadowDomName:"shade-tab-header",style:{padding:"1em 2.5em",cursor:"pointer",transition:"box-shadow 1s linear"},elementBase:HTMLAnchorElement,elementBaseName:"a",render:({children:e,element:t,injector:n,props:i,useObservable:s})=>{const{theme:o}=n.getInstance(O),r=n.getInstance($),[a]=s("updateLocation",r.onLocationHashChanged),d=a===i.hash;return R(t,{style:{fontWeight:d?"bolder":"inherit",background:d?o.background.paper:o.background.default,color:d?o.text.primary:o.text.secondary,boxShadow:d?`inset 0 -2px 0 ${o.palette.primary.main}`:"none"},href:`#${i.hash}`}),c(c,null,e)}});y({shadowDomName:"shade-tabs",render:({props:e,element:t,useObservable:n,injector:i})=>{R(t,{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",...e.containerStyle}});const[s]=n("updateLocation",i.getInstance($).onLocationHashChanged),o=e.tabs.find(r=>r.hash===s.replace("#",""));return c(c,null,c("div",{className:"shade-tabs-header-container",style:{display:"inline-flex",borderRadius:"5px 5px 0 0",overflow:"hidden",flexShrink:"0"}},e.tabs.map(r=>c(xi,{hash:r.hash},r.header))),o==null?void 0:o.component)}});const Si=async(e,t)=>{const n=e.firstChild;n&&(t?(n.value="",await b(e,[{width:"0%"},{width:"100%"}],{duration:300,fill:"forwards",easing:"cubic-bezier(0.595, 0.425, 0.415, 0.845)"}),n.focus()):(await b(e,[{width:"100%"},{width:"0%"}],{duration:300,fill:"forwards",easing:"cubic-bezier(0.595, 0.425, 0.415, 0.845)"}),n.value=""))},Oi=y({shadowDomName:"shades-command-palette-input",render:({element:e,props:t,injector:n,useObservable:i})=>{const{theme:s}=n.getInstance(O),{manager:o}=t,[r]=i("isOpened",o.isOpened,{onChange:a=>void Si(e,a)});return e.style.width=r?"100%":"0%",e.style.overflow="hidden",c("input",{autofocus:!0,style:{color:s.text.primary,outline:"none",padding:"1em",background:"transparent",border:"none",display:"inline-flex",width:"calc(100% - 2em)"}})}});var Ci=function(e,t,n,i){var s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},Ii=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)};let De=class{constructor(t){g(this,"commandProviders");g(this,"isOpened",new v(!1));g(this,"isLoading",new v(!1));g(this,"term",new v(""));g(this,"selectedIndex",new v(0));g(this,"currentSuggestions",new v([]));g(this,"keyPressListener",(t=>{t.key&&t.key.toLowerCase()==="p"&&t.ctrlKey&&(this.isOpened.setValue(!0),this.currentSuggestions.setValue([])),t.key==="Escape"&&this.isOpened.setValue(!1)}).bind(this));g(this,"lastGetSuggestionOptions");g(this,"getSuggestion",vt(async t=>{var n;try{if(((n=this.lastGetSuggestionOptions)==null?void 0:n.term)===t.term)return;this.isLoading.setValue(!0),this.lastGetSuggestionOptions=t,this.currentSuggestions.setValue([]),this.selectedIndex.setValue(0),await Promise.all(this.commandProviders.map(async i=>{const s=await i(t);this.lastGetSuggestionOptions===t&&this.currentSuggestions.setValue([...this.currentSuggestions.getValue(),...s].sortBy("score"))}))}finally{this.isLoading.setValue(!1)}},250));this.commandProviders=t,window.addEventListener("keyup",this.keyPressListener,!0)}[Symbol.dispose](){window.removeEventListener("keyup",this.keyPressListener),this.isOpened[Symbol.dispose](),this.isLoading[Symbol.dispose](),this.term[Symbol.dispose](),this.selectedIndex[Symbol.dispose](),this.currentSuggestions[Symbol.dispose]()}selectSuggestion(t,n=this.selectedIndex.getValue()){const i=this.currentSuggestions.getValue()[n];this.isOpened.setValue(!1),i.onSelected({injector:t})}};De=Ci([_({lifetime:"singleton"}),Ii("design:paramtypes",[Array])],De);const Ei=y({shadowDomName:"shade-command-palette-suggestion-list",render:({element:e,injector:t,props:n,useObservable:i})=>{var l;const{manager:s}=n,{theme:o}=t.getInstance(O),[r]=i("suggestions",n.manager.currentSuggestions),[a]=i("selectedIndex",n.manager.selectedIndex,{onChange:h=>{[...e.querySelectorAll(".suggestion-item")].map((u,f)=>{f===h?(u.style.background=o.background.paper,u.style.fontWeight="bolder"):(u.style.background=o.background.default,u.style.fontWeight="normal")})}}),[d]=i("isOpenedAtRender",n.manager.isOpened,{onChange:h=>{var f;const u=e.firstElementChild;h?(u.style.display="initial",u.style.zIndex="1",u.style.width=`calc(${Math.round(((f=e.parentElement)==null?void 0:f.getBoundingClientRect().width)||200)}px - 3em)`,b(u,[{opacity:0,transform:"translate(0, -50px)"},{opacity:1,transform:"translate(0, 0)"}],{fill:"forwards",duration:500})):(b(u,[{opacity:1,transform:"translate(0, 0)"},{opacity:0,transform:"translate(0, -50px)"}],{fill:"forwards",duration:200}),u.style.zIndex="-1",u.style.display="none")}});return c("div",{className:"suggestion-items-container",style:{borderTop:"none",position:"absolute",opacity:s.isOpened.getValue()?"1":"0",borderRadius:"0px 0px 5px 5px",marginLeft:"14px",overflow:"hidden",overflowY:"auto",maxHeight:`${window.innerHeight*.8}px`,zIndex:"1",left:"auto",backgroundColor:o.background.paper,boxShadow:"3px 3px 5px rgba(0,0,0,0.3)",width:`calc(${Math.round(((l=e.parentElement)==null?void 0:l.getBoundingClientRect().width)||200)}px - 3em)`,...n.fullScreenSuggestions?{left:"0",width:"calc(100% - 42px)"}:{}}},r.map((h,u)=>c("div",{className:"suggestion-item",onclick:()=>{d&&s.selectSuggestion(t,u)},style:{padding:"1em",cursor:"default",background:u===a?o.background.paper:o.background.default,fontWeight:u===a?"bolder":"normal"}},h.element)))}});y({shadowDomName:"shade-command-palette",render:({props:e,injector:t,element:n,useState:i,useDisposable:s,useObservable:o})=>{n.style.flexGrow="1";const[r]=i("manager",new De(e.commandProviders)),{theme:a}=t.getInstance(O);s("clickAwayService",()=>new jt(n,()=>r.isOpened.setValue(!1)));const[d]=o("isLoading",r.isLoading,{onChange:u=>{const f=n.querySelector(".loader-container");u?b(f,[{opacity:0},{opacity:1}],{duration:100,fill:"forwards"}):b(f,[{opacity:1},{opacity:0}],{duration:100,fill:"forwards"})}}),[l,h]=o("isOpened",r.isOpened,{onChange:u=>{{const f=n.querySelector(".close-suggestions"),p=n.querySelector(".post-controls"),m=n.querySelector(".input-container");u?(b(f,[{opacity:0},{opacity:1}],{duration:500,fill:"forwards"}),b(p,[{width:"0px"},{width:"50px"}],{duration:100,fill:"forwards"}),b(m,[{background:"transparent"},{background:a.background.default}],{duration:500,fill:"forwards",easing:"cubic-bezier(0.050, 0.570, 0.840, 1.005)"})):(b(f,[{opacity:1},{opacity:0}],{duration:500,fill:"forwards"}),b(p,[{width:"50px"},{width:"0px"}],{duration:500,fill:"forwards",delay:300}),b(m,[{background:a.background.default},{background:"transparent"}],{duration:300,fill:"forwards",easing:"cubic-bezier(0.000, 0.245, 0.190, 0.790)"}))}}});return c("div",{style:{display:"flex",flexDirection:"column"},onkeyup:u=>{if(u.key==="Enter"){u.preventDefault(),r.selectSuggestion(t);return}u.key==="ArrowUp"&&(u.preventDefault(),r.selectedIndex.setValue(Math.max(0,r.selectedIndex.getValue()-1))),u.key==="ArrowDown"&&(u.preventDefault(),r.selectedIndex.setValue(Math.min(r.selectedIndex.getValue()+1,r.currentSuggestions.getValue().length-1))),r.getSuggestion({injector:t,term:u.target.value})}},c("div",{className:"input-container",style:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 1em",borderRadius:"5px",position:"relative",...e.style}},c("div",{className:"term-icon",style:{cursor:"pointer",color:"#aaa",fontWeight:"bolder",textShadow:"0 0 1px #aaa"},onclick:()=>h(!0)},e.defaultPrefix),c(Oi,{manager:r}),c("div",{className:"post-controls",style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:l?"50px":"0px",overflow:"hidden"}},c("div",{className:"loader-container",style:{width:"20px",height:"20px",opacity:d?"1":"0"}},c(Vt,{style:{width:"100%",height:"100%"}})),c("div",{className:"close-suggestions",onclick:()=>h(!1),style:{width:"20px",height:"20px",opacity:r.isOpened.getValue()?"1":"0",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}},"✖"))),c(Ei,{manager:r,fullScreenSuggestions:e.fullScreenSuggestions}))}});y({shadowDomName:"shades-wizard",render:({props:e,useState:t})=>{const[n,i]=t("currentPage",0),s=e.steps[n];return c("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}},c(mi,{style:{maxWidth:"100%",maxHeight:"100%"},elevation:3,onclick:o=>o.stopPropagation()},c(s,{currentPage:n,maxPages:e.steps.length,onNext:()=>{var o;n<e.steps.length-1?i(n+1):(o=e.onFinish)==null||o.call(e)},onPrev:()=>{n>0&&i(n-1)}})))}});const _i={primary:{light:"#6573c3",main:"#3f51b5",dark:"#2c387e"},secondary:{light:"#4aedc4",main:"#1de9b6",dark:"#14a37f"},error:{light:"#e57373",main:"#f44336",dark:"#a31f1f"},warning:{light:"#ffb74d",main:"#ff9800",dark:"#f57c00"},info:{light:"#64b5f6",main:"#2196f3",dark:"#1976d2"},success:{light:"#81c784",main:"#4caf50",dark:"#388e3c"}},Di={name:"default-dark-theme",text:{primary:"#fff",secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)"},button:{active:"#fff",hover:"rgba(255, 255, 255, 0.08)",selected:"rgba(255, 255, 255, 0.16)",disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)"},background:{default:"#303030",paper:"#424242"},palette:_i,divider:"rgba(0, 0, 0, 0.12)"},de=(e,t)=>{const n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)},ki=(e,t)=>{const n=t.x-e.x,i=t.y-e.y;return Ni(Math.atan2(i,n))},Li=(e,t,n)=>{const i={x:0,y:0};return n=ke(n),i.x=e.x-t*Math.cos(n),i.y=e.y-t*Math.sin(n),i},ke=e=>e*(Math.PI/180),Ni=e=>e*(180/Math.PI),Ri=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,xe=new Map,ot=e=>{xe.has(e)&&clearTimeout(xe.get(e)),xe.set(e,setTimeout(e,100))},ge=(e,t,n)=>{const i=t.split(/[ ,]+/g);let s;for(let o=0;o<i.length;o+=1)s=i[o],e.addEventListener?e.addEventListener(s,n,!1):e.attachEvent&&e.attachEvent(s,n)},rt=(e,t,n)=>{const i=t.split(/[ ,]+/g);let s;for(let o=0;o<i.length;o+=1)s=i[o],e.removeEventListener?e.removeEventListener(s,n):e.detachEvent&&e.detachEvent(s,n)},$t=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),at=()=>{const e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},lt=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},Fe=(e,t,n)=>{const i=Mt(e);for(let s in i)if(i.hasOwnProperty(s))if(typeof t=="string")i[s]=t+" "+n;else{let o="";for(let r=0,a=t.length;r<a;r+=1)o+=t[r]+" "+n+", ";i[s]=o.slice(0,-2)}return i},Pi=(e,t)=>{const n=Mt(e);for(let i in n)n.hasOwnProperty(i)&&(n[i]=t);return n},Mt=e=>{const t={};return t[e]="",["webkit","Moz","o"].forEach(function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},Se=(e,t)=>{for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},Ti=(e,t)=>{const n={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?n[i]=t[i]:e.hasOwnProperty(i)&&(n[i]=e[i]);return n},Le=(e,t)=>{if(e.length)for(let n=0,i=e.length;n<i;n+=1)t(e[n]);else t(e)},ji=(e,t,n)=>({x:Math.min(Math.max(e.x,t.x-n),t.x+n),y:Math.min(Math.max(e.y,t.y-n),t.y+n)});var Vi="ontouchstart"in window,$i=!!window.PointerEvent,Mi=!!window.MSPointerEvent,J={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},B,Y={};$i?B=J.pointer:Mi?B=J.MSPointer:Vi?(B=J.touch,Y=J.mouse):B=J.mouse;function j(){}j.prototype.on=function(e,t){var n=this,i=e.split(/[ ,]+/g),s;n._handlers_=n._handlers_||{};for(var o=0;o<i.length;o+=1)s=i[o],n._handlers_[s]=n._handlers_[s]||[],n._handlers_[s].push(t);return n};j.prototype.off=function(e,t){var n=this;return n._handlers_=n._handlers_||{},e===void 0?n._handlers_={}:t===void 0?n._handlers_[e]=null:n._handlers_[e]&&n._handlers_[e].indexOf(t)>=0&&n._handlers_[e].splice(n._handlers_[e].indexOf(t),1),n};j.prototype.trigger=function(e,t){var n=this,i=e.split(/[ ,]+/g),s;n._handlers_=n._handlers_||{};for(var o=0;o<i.length;o+=1)s=i[o],n._handlers_[s]&&n._handlers_[s].length&&n._handlers_[s].forEach(function(r){r.call(n,{type:s,target:n},t)})};j.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=Ti(t.options,e))};j.prototype.bindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[t]=function(){typeof n["on"+t]=="function"?n["on"+t].apply(n,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},ge(e,B[t],n._domHandlers_[t]),Y[t]&&ge(e,Y[t],n._domHandlers_[t]),n};j.prototype.unbindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},rt(e,B[t],n._domHandlers_[t]),Y[t]&&rt(e,Y[t],n._domHandlers_[t]),delete n._domHandlers_[t],this};function I(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=I.id,I.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}I.prototype=new j;I.constructor=I;I.id=0;I.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};I.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=Pi("borderRadius","50%"),n=Fe("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},Se(i.el,n),this.options.shape==="circle"&&Se(i.back,t),Se(i.front,t),this.applyStyles(i),this};I.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var n in e[t])this.ui[t].style[n]=e[t][n];return this};I.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};I.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};I.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};I.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};I.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var n=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=n,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){const n=t.options.restJoystick,i={};i.x=n===!0||n.x!==!1?0:t.instance.frontPosition.x,i.y=n===!0||n.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t};I.prototype.setPosition=function(e,t){var n=this;n.frontPosition={x:t.x,y:t.y};var i=n.options.fadeTime+"ms",s={};s.front=Fe("transition",["transform"],i);var o={front:{}};o.front={transform:"translate("+n.frontPosition.x+"px,"+n.frontPosition.y+"px)"},n.applyStyles(s),n.applyStyles(o),n.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(n),n.restCallback()},n.options.fadeTime)};I.prototype.restCallback=function(){var e=this,t={};t.front=Fe("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};I.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};I.prototype.computeDirection=function(e){var t=e.angle.radian,n=Math.PI/4,i=Math.PI/2,s,o,r;if(t>n&&t<n*3&&!e.lockX?s="up":t>-n&&t<=n&&!e.lockY?s="left":t>-n*3&&t<=-n&&!e.lockX?s="down":e.lockY||(s="right"),e.lockY||(t>-i&&t<i?o="left":o="right"),e.lockX||(t>0?r="up":r="down"),e.force>this.options.threshold){var a={},d;for(d in this.direction)this.direction.hasOwnProperty(d)&&(a[d]=this.direction[d]);var l={};this.direction={x:o,y:r,angle:s},e.direction=this.direction;for(d in a)a[d]===this.direction[d]&&(l[d]=!0);if(l.x&&l.y&&l.angle)return e;(!l.x||!l.y)&&this.trigger("plain",e),l.x||this.trigger("plain:"+o,e),l.y||this.trigger("plain:"+r,e),l.angle||this.trigger("dir dir:"+s,e)}else this.resetDirection();return e};function C(e,t){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=e,n.id=C.id,C.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(t),(n.options.mode==="static"||n.options.mode==="semi")&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);const i=getComputedStyle(n.options.zone.parentElement);return i&&i.display==="flex"&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}C.prototype=new j;C.constructor=C;C.id=0;C.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(n){if(n===void 0)return t[0];for(var i=0,s=t.length;i<s;i+=1)if(t[i].identifier===n)return t[i];return!1}};C.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};C.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var n=e.createNipple(t.position,e.manager.getIdentifier());n.add(),e.idles.push(n)}};C.prototype.createNipple=function(e,t){var n=this,i=n.manager.scroll,s={},o=n.options,r={x:n.parentIsFlex?i.x:i.x+n.box.left,y:n.parentIsFlex?i.y:i.y+n.box.top};if(e.x&&e.y)s={x:e.x-r.x,y:e.y-r.y};else if(e.top||e.right||e.bottom||e.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=e.top,a.style.right=e.right,a.style.bottom=e.bottom,a.style.left=e.left,a.style.position="absolute",o.zone.appendChild(a);var d=a.getBoundingClientRect();o.zone.removeChild(a),s=e,e={x:d.left+i.x,y:d.top+i.y}}var l=new I(n,{color:o.color,size:o.size,threshold:o.threshold,fadeTime:o.fadeTime,dataOnly:o.dataOnly,restJoystick:o.restJoystick,restOpacity:o.restOpacity,mode:o.mode,identifier:t,position:e,zone:o.zone,frontPosition:{x:0,y:0},shape:o.shape});return o.dataOnly||(lt(l.ui.el,s),lt(l.ui.front,l.frontPosition)),n.nipples.push(l),n.trigger("added "+l.identifier+":added",l),n.manager.trigger("added "+l.identifier+":added",l),n.bindNipple(l),l};C.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};C.prototype.bindNipple=function(e){var t=this,n,i=function(s,o){n=s.type+" "+o.id+":"+s.type,t.trigger(n,o)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};C.prototype.pressureFn=function(e,t,n){var i=this,s=0;clearInterval(i.pressureIntervals[n]),i.pressureIntervals[n]=setInterval((function(){var o=e.force||e.pressure||e.webkitForce||0;o!==s&&(t.trigger("pressure",o),i.trigger("pressure "+t.identifier+":pressure",o),s=o)}).bind(i),100)};C.prototype.onstart=function(e){var t=this,n=t.options,i=e;e=$t(e),t.updateBox();var s=function(o){t.actives.length<n.maxNumberOfNipples?t.processOnStart(o):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(r){if(Object.values(i.touches).findIndex(function(d){return d.identifier===r})<0){var a=[e[0]];a.identifier=r,t.processOnEnd(a)}}),t.actives.length<n.maxNumberOfNipples&&t.processOnStart(o))};return Le(e,s),t.manager.bindDocument(),!1};C.prototype.processOnStart=function(e){var t=this,n=t.options,i,s=t.manager.getIdentifier(e),o=e.force||e.pressure||e.webkitForce||0,r={x:e.pageX,y:e.pageY},a=t.getOrCreate(s,r);a.identifier!==s&&t.manager.removeIdentifier(a.identifier),a.identifier=s;var d=function(h){h.trigger("start",h),t.trigger("start "+h.id+":start",h),h.show(),o>0&&t.pressureFn(e,h,h.identifier),t.processOnMove(e)};if((i=t.idles.indexOf(a))>=0&&t.idles.splice(i,1),t.actives.push(a),t.ids.push(a.identifier),n.mode!=="semi")d(a);else{var l=de(r,a.position);if(l<=n.catchDistance)d(a);else{a.destroy(),t.processOnStart(e);return}}return a};C.prototype.getOrCreate=function(e,t){var n=this,i=n.options,s;return/(semi|static)/.test(i.mode)?(s=n.idles[0],s?(n.idles.splice(0,1),s):i.mode==="semi"?n.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(s=n.createNipple(t,e),s)};C.prototype.processOnMove=function(e){var t=this,n=t.options,i=t.manager.getIdentifier(e),s=t.nipples.get(i),o=t.manager.scroll;if(!Ri(e)){this.processOnEnd(e);return}if(!s){console.error("Found zombie joystick with ID "+i),t.manager.removeIdentifier(i);return}if(n.dynamicPage){var r=s.el.getBoundingClientRect();s.position={x:o.x+r.left,y:o.y+r.top}}s.identifier=i;var a=s.options.size/2,d={x:e.pageX,y:e.pageY};n.lockX&&(d.y=s.position.y),n.lockY&&(d.x=s.position.x);var l=de(d,s.position),h=ki(d,s.position),u=ke(h),f=l/a,p={distance:l,position:d},m,S;if(s.options.shape==="circle"?(m=Math.min(l,a),S=Li(s.position,m,h)):(S=ji(d,s.position,a),m=de(S,s.position)),n.follow){if(l>a){let k=d.x-S.x,L=d.y-S.y;s.position.x+=k,s.position.y+=L,s.el.style.top=s.position.y-(t.box.top+o.y)+"px",s.el.style.left=s.position.x-(t.box.left+o.x)+"px",l=de(d,s.position)}}else d=S,l=m;var w=d.x-s.position.x,x=d.y-s.position.y;s.frontPosition={x:w,y:x},n.dataOnly||(s.ui.front.style.transform="translate("+w+"px,"+x+"px)");var D={identifier:s.identifier,position:d,force:f,pressure:e.force||e.pressure||e.webkitForce||0,distance:l,angle:{radian:u,degree:h},vector:{x:w/a,y:-x/a},raw:p,instance:s,lockX:n.lockX,lockY:n.lockY};D=s.computeDirection(D),D.angle={radian:ke(180-h),degree:180-h},s.trigger("move",D),t.trigger("move "+s.id+":move",D)};C.prototype.processOnEnd=function(e){var t=this,n=t.options,i=t.manager.getIdentifier(e),s=t.nipples.get(i),o=t.manager.removeIdentifier(s.identifier);s&&(n.dataOnly||s.hide(function(){n.mode==="dynamic"&&(s.trigger("removed",s),t.trigger("removed "+s.id+":removed",s),t.manager.trigger("removed "+s.id+":removed",s),s.destroy())}),clearInterval(t.pressureIntervals[s.identifier]),s.resetDirection(),s.trigger("end",s),t.trigger("end "+s.id+":end",s),t.ids.indexOf(s.identifier)>=0&&t.ids.splice(t.ids.indexOf(s.identifier),1),t.actives.indexOf(s)>=0&&t.actives.splice(t.actives.indexOf(s),1),/(semi|static)/.test(n.mode)?t.idles.push(s):t.nipples.indexOf(s)>=0&&t.nipples.splice(t.nipples.indexOf(s),1),t.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(t.manager.ids[o.id]=o.identifier))};C.prototype.onDestroyed=function(e,t){var n=this;n.nipples.indexOf(t)>=0&&n.nipples.splice(n.nipples.indexOf(t),1),n.actives.indexOf(t)>=0&&n.actives.splice(n.actives.indexOf(t),1),n.idles.indexOf(t)>=0&&n.idles.splice(n.idles.indexOf(t),1),n.ids.indexOf(t.identifier)>=0&&n.ids.splice(n.ids.indexOf(t.identifier),1),n.manager.removeIdentifier(t.identifier),n.manager.unbindDocument()};C.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(n){n.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};function E(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=at(),t.config(e),t.prepareCollections();var n=function(){var s;t.collections.forEach(function(o){o.forEach(function(r){s=r.el.getBoundingClientRect(),r.position={x:t.scroll.x+s.left,y:t.scroll.y+s.top}})})};ge(window,"resize",function(){ot(n)});var i=function(){t.scroll=at()};return ge(window,"scroll",function(){ot(i)}),t.collections}E.prototype=new j;E.constructor=E;E.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var n;return e.collections.every(function(i){return n=i.get(t),!n}),n}};E.prototype.create=function(e){return this.createCollection(e)};E.prototype.createCollection=function(e){var t=this,n=new C(t,e);return t.bindCollection(n),t.collections.push(n),n};E.prototype.bindCollection=function(e){var t=this,n,i=function(s,o){n=s.type+" "+o.id+":"+s.type,t.trigger(n,o)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};E.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};E.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};E.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};E.prototype.removeIdentifier=function(e){var t={};for(var n in this.ids)if(this.ids[n]===e){t.id=n,t.identifier=this.ids[n],delete this.ids[n];break}return t};E.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};E.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};E.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};E.prototype.onAny=function(e,t){var n=this,i,s="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=$t(t);var o=function(a,d,l){l.ids.indexOf(d)>=0&&(l[s](a),a._found_=!0)},r=function(a){i=n.getIdentifier(a),Le(n.collections,o.bind(null,a,i)),a._found_||n.removeIdentifier(i)};return Le(t,r),!1};E.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};E.prototype.onDestroyed=function(e,t){var n=this;if(n.collections.indexOf(t)<0)return!1;n.collections.splice(n.collections.indexOf(t),1)};const ct=new E,zi={create:function(e){return ct.create(e)},factory:ct},Ai=y({shadowDomName:"shade-nipple",constructed:async({element:e,props:t})=>{const n=zi.create({zone:e,...t.managerOptions});return t.onStart&&n.on("start",t.onStart),t.onEnd&&n.on("end",t.onEnd),t.onDir&&n.on("dir",t.onDir),t.onMove&&n.on("move",t.onMove),()=>n.destroy()},render:({children:e})=>e?c(c,null,e):c("div",null)});var Fi=Object.defineProperty,Bi=Object.getOwnPropertyDescriptor,Be=(e,t,n,i)=>{for(var s=i>1?void 0:i?Bi(t,n):t,o=e.length-1,r;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&Fi(t,n,s),s};let T=class{constructor(){this.isConnected=new v(!1),this.eventStream=[],this.lastMessage=new v({data:"null",type:"connection",dataObject:null}),this.onConnect=(()=>{this.logger.verbose({message:"Connected",data:{socket:this.socket}}),this.isConnected.setValue(!0)}).bind(this),this.onDisconnect=(()=>{this.logger.verbose({message:"Disconnected",data:{socket:this.socket}}),this.isConnected.setValue(!1),this.disposeSocket(this.socket),this.socket=this.createSocket(),this.lastMessage.setValue({type:"connection",data:"Socket disconnected"})}).bind(this),this.onOpen=(()=>{this.logger.verbose({message:"Opened",data:{socket:this.socket}}),this.lastMessage.setValue({type:"connection",data:"Socket opened"})}).bind(this),this.onClose=(()=>{this.logger.verbose({message:"Closed",data:{socket:this.socket}}),this.lastMessage.setValue({type:"connection",data:"Socket closed"})}).bind(this),this.onError=(()=>{this.logger.warning({message:"Socket Error",data:{socket:this.socket}}),this.lastMessage.setValue({type:"connection",data:"Socket Error"})}).bind(this),this.onMessage=(e=>{try{const t={type:"incoming",data:e.data.toString(),dataObject:JSON.parse(e.data.toString()),date:new Date};this.eventStream.push(t),this.lastMessage.setValue(t)}catch{this.lastMessage.setValue({type:"incoming",data:e.data.toString()})}this.logger.verbose({message:"Message received",data:{socket:this.socket,data:e.data}})}).bind(this)}send(e){this.socket.readyState===WebSocket.OPEN&&(this.socket.send(e),this.lastMessage.setValue({type:"outgoing",data:e}))}init(){this.socket=this.createSocket()}createSocket(){const e=new WebSocket("ws://"+qt.joinPaths(this.env.site,"ws"));return e.addEventListener("connect",this.onConnect),e.addEventListener("disconnect",this.onDisconnect),e.addEventListener("open",this.onOpen),e.addEventListener("close",this.onClose),e.addEventListener("error",this.onError),e.addEventListener("message",this.onMessage),e}disposeSocket(e){e.removeEventListener("connect",this.onConnect),e.removeEventListener("disconnect",this.onDisconnect),e.removeEventListener("open",this.onOpen),e.removeEventListener("close",this.onClose),e.removeEventListener("error",this.onError),e.removeEventListener("message",this.onMessage)}dispose(){this.socket&&this.disposeSocket(this.socket),this.lastMessage[Symbol.dispose]()}};Be([X(e=>Ct(e).withScope("WebSocketService"))],T.prototype,"logger",2);Be([X(V)],T.prototype,"env",2);T=Be([_({lifetime:"singleton"})],T);var Hi=Object.defineProperty,qi=Object.getOwnPropertyDescriptor,Ui=(e,t,n,i)=>{for(var s=i>1?void 0:i?qi(t,n):t,o=e.length-1,r;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&Hi(t,n,s),s};const dt="FLEA_SETTINGS";let Ne=class{constructor(e){this.currentSettings=new v({isPidEnabled:!0,throttleSensitivity:32,steerSensitivity:32}),this.logger=e.logger.withScope("ClientSettings"),this.initConfig()}initConfig(){const e=localStorage.getItem(dt);try{const t=JSON.parse(e||"");this.currentSettings.setValue({...this.currentSettings.getValue(),...t})}catch{this.logger.warning({message:"Failed to parse stored settings. Resetting to defaults..."}),localStorage.removeItem(dt)}}};Ne=Ui([_({lifetime:"singleton"})],Ne);var Gi=Object.defineProperty,Wi=Object.getOwnPropertyDescriptor,be=(e,t,n,i)=>{for(var s=i>1?void 0:i?Wi(t,n):t,o=e.length-1,r;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&Gi(t,n,s),s};let U=class{constructor(){this.currentValues=new v({throttle:0,steer:0,sent:!1}),this.sendInterval=setInterval(()=>{const{throttle:e,steer:t,sent:n}=this.currentValues.getValue();n||(this.webSocket.send(`move ${Math.round(e)} ${Math.round(t)}`),this.currentValues.setValue({throttle:e,steer:t,sent:!0}))},150)}stop(){this.logger.verbose({message:"Stopped"}),this.webSocket.send("move 0 0")}async move(e,t){this.logger.verbose({message:"Movement change",data:{throttle:e,steer:t}}),this.currentValues.setValue({throttle:e,steer:t,sent:!1})}};be([X(e=>Ct(e).withScope("movementService"))],U.prototype,"logger",2);be([X(T)],U.prototype,"webSocket",2);be([X(Ne)],U.prototype,"_settings",2);U=be([_({lifetime:"singleton"})],U);const Ji=y({shadowDomName:"flea-joystick-page",render:({injector:e})=>{const t=e.getInstance(U);return c("div",{style:{width:"100%",height:"100%",position:"relative"}},c("img",{src:`http://${e.getInstance(V).site}/cam`,alt:"webcam-image",style:{objectFit:"cover",width:"100%",height:"100%",zIndex:"-1"},onload:n=>{const i=n.target;i.complete&&i.isConnected&&(i.src=`http://${e.getInstance(V).site}/cam?refresh=${Math.random()}`)},onerror:n=>{const i=n.target;i.complete&&i.isConnected&&(i.src=`http://${e.getInstance(V).site}/cam?refresh=${Math.random()}`)}}),c(Ai,{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},managerOptions:{},onEnd:()=>t.stop(),onMove:(n,i)=>{var r;const s=Math.round(i.force*20*(((r=i.direction)==null?void 0:r.y)==="down"?-1:1)),o=Math.round(Math.cos(i.angle.radian)*110);t.move(s,o)}}))}}),Qi=y({shadowDomName:"flea-console-entries",constructed:({injector:e,element:t,useDisposable:n})=>{n("lastMessageSubscription",()=>e.getInstance(T).lastMessage.subscribe(()=>{var i,s;(s=t.parentElement)==null||s.scrollTo({top:((i=t.firstElementChild)==null?void 0:i.scrollHeight)||Number.MAX_SAFE_INTEGER})}))},render:({injector:e,useObservable:t})=>(t("lastMessage",e.getInstance(T).lastMessage),c("div",{style:{marginTop:"32px"}},e.getInstance(T).eventStream.map(n=>c("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",fontFamily:"monospace"}},c("div",{style:{fontSize:"20px",width:"40px",height:"40px",textAlign:"center",verticalAlign:"middle",lineHeight:"40px",flexShrink:"0",marginRight:"1em",color:n.type==="incoming"?"#aa2233":"#22bb33"}},n.type==="incoming"?"<":n.type==="outgoing"?">":"|"),n.dataObject?c("code",{style:{whiteSpace:"pre-wrap"}},JSON.stringify(n.dataObject,void 0,2)):c("div",null," ",n.data," ")))))}),Yi=y({shadowDomName:"flea-console-page",render:({useDisposable:e,injector:t})=>{const n=t.getInstance(T),i=e("command",()=>new v(""));return c("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",color:"#bbb"}},c("div",{style:{flexGrow:"1",overflow:"auto",height:"100px",padding:"1em"}},c(Qi,null)),c("form",{style:{display:"flex",flexDirection:"row",width:"100%",flexShrink:"0"},onsubmit:s=>{s.preventDefault(),n.send(i.getValue()),s.target.reset()}},c("input",{autofocus:!0,style:{display:"block",flexGrow:"1",width:"100%"},placeholder:"Command",onkeyup:s=>i.setValue(s.target.value)}),c(q,{title:"Send",type:"submit"},"Send")))}}),Xi=y({shadowDomName:"flea-update-page",render:({injector:e})=>c("div",{style:{display:"flex",height:"100%",justifyContent:"center",alignItems:"center"}},c("form",{style:{display:"flex",flexDirection:"column"},action:"http://"+e.getInstance(V).site+"/update",accept:"application/octet-stream",enctype:"multipart/form-data",method:"POST"},c("div",null,c("input",{type:"file",name:"update",style:{margin:"2em"},accept:"application/octet-stream"}),c("input",{type:"submit",value:"Update"}))))}),Ki=y({shadowDomName:"flea-layout",render:()=>c("div",{style:{width:"100%",height:"100%",overflow:"hidden",display:"flex",flexDirection:"column",lineHeight:"18px"}},c(Yn,null,c(te,{href:"/",style:{marginRight:"2em"}},"Flea")," ",c(te,{href:"/"},"Home")," | ",c(te,{href:"/console"},"Console")," | ",c(te,{href:"/update"},"Update"),c("div",{style:{flex:"1"}})),c("div",{style:{width:"100%",height:"100%",flexGrow:"1"}},c(Mn,{routes:[{url:"/",component:()=>c(Ji,null)},{url:"/console",component:()=>c(Yi,null)},{url:"/update",component:()=>c(Xi,null)}]})))}),He=new H;Pt(Di);on(He,Ie);He.setExplicitInstance({site:"192.168.0.38"},V);const Zi=document.getElementById("root");An({rootElement:Zi,injector:He,jsxElement:c(Ki,null)});
